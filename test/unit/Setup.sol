// SPDX-License-Identifier: GPL-3
pragma solidity 0.8.23;

import {Test} from "forge-std/Test.sol";
import {SAMM, ISAMM} from "../../src/SAMM.sol";
import {ModuleGuard} from "../../src/ModuleGuard.sol";
import {SafeProxyFactory} from "../../src/Safe/proxy/SafeProxyFactory.sol";

import {ISafe} from "../../src/Safe/interfaces/ISafe.sol";
import {IMinimalSafeModuleManager} from "../../src/Safe/interfaces/IMinimalSafeModuleManager.sol";
import {ArrHelper} from "../helpers/ArrHelper.sol";
import {IDKIMRegistry} from "../../src/interfaces/IDKIMRegistry.sol";
import {DKIMRegistry} from "../../src/utils/DKIMRegistry.sol";

contract Setup is Test {
    //////////////////////
    //    Constants     //
    //////////////////////

    // Safe in mainnet
    address internal constant SAFE_SINGLETON = 0x41675C099F32341bf84BFc5382aF534df5C7461a;
    SafeProxyFactory internal constant SAFE_PROXY_FACTORY = SafeProxyFactory(0x4e1DCf7AD4e460CfD30791CCC4F9c8a4f820ec67);

    // Helpers for tests
    uint256 internal constant DEFAULT_ROOT =
        20511819156590425064232637729680364151906840836244771318276577108131705348606; // From default accounts

    uint64 internal constant DEFAULT_THRESHOLD = 1;
    string internal constant DEFAULT_RELAYER = "ad@oxor.io";
    string internal constant DEFAULT_DOMAIN = "icloud.com";
    bytes32 internal constant DEFAULT_PUBKEY_HASH = 0x1dda80724c52fd74cef39e7c18fe8c5676ee1f95029ebc3c9b7ba5abd40919cb;
    address internal constant DEFAULT_TO = 0xdAC17F958D2ee523a2206206994597C13D831ec7; // USDT on mainnet
    bytes internal constant DEFAULT_CALLDATA = abi.encodeWithSignature("totalSupply()");
    uint256 internal constant DEFAULT_DEADLINE = 4884818384; // Tue Oct 17 2124 05:59:44
    uint256 internal constant DEFAULT_SALT = uint256(keccak256(abi.encode(777)));

    //////////////////////
    // State Variables  //
    //////////////////////

    // Safe
    ISafe internal safe;

    // DKIM registry
    DKIMRegistry internal dkimRegistry;

    // SAM
    SAMM internal sam;
    SAMM internal samSingleton;
    SafeProxyFactory internal samProxyFactory;

    // Guard
    ModuleGuard internal guard;
    ModuleGuard internal guardSingleton;
    SafeProxyFactory internal guardProxyFactory;

    //////////////////////
    //    Modifiers     //
    //////////////////////

    modifier fork(string memory env_var) {
        string memory RPC_URL = vm.envString(env_var);
        vm.createSelectFork(RPC_URL);
        _;
    }

    modifier enableModuleForSafe(ISafe safeContract, SAMM module) {
        enableModule(address(safeContract), address(module));
        _;
    }

    //////////////////////
    //  Help functions  //
    //////////////////////

    function setUp() public virtual fork("MAINNET_RPC") {
        safe = createMinimalSafeWallet(ArrHelper._arr(address(this)), DEFAULT_THRESHOLD, DEFAULT_SALT);

        dkimRegistry = new DKIMRegistry(address(this));
        dkimRegistry.setDKIMPublicKeyHash(DEFAULT_DOMAIN, DEFAULT_PUBKEY_HASH);

        // Create SAM module
        samSingleton = new SAMM();
        samProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataSAM = abi.encodeCall(
            SAMM.setup,
            (
                address(safe),
                DEFAULT_ROOT,
                DEFAULT_THRESHOLD,
                DEFAULT_RELAYER,
                address(dkimRegistry),
                new ISAMM.TxAllowance[](0)
            )
        );

        sam = createSAM(initializeDataSAM, DEFAULT_SALT);

        // add TxAllowances
        bytes memory data = DEFAULT_CALLDATA;
        bytes4 selector;
        assembly {
            selector := mload(add(data, 0x20))
        }
        vm.prank(address(safe));
        ISAMM.TxAllowance memory txAllowance = ISAMM.TxAllowance(DEFAULT_TO, selector, 0, IMinimalSafeModuleManager.Operation.Call);
        sam.setTxAllowed(txAllowance, true);

        // Create Guard module
        guardSingleton = new ModuleGuard();
        guardProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataGuard = abi.encodeCall(ModuleGuard.setup, (address(safe)));
        guard = createGuard(initializeDataGuard, DEFAULT_SALT);
    }

    function createSAM(bytes memory initData, uint256 salt) internal returns (SAMM newSAM) {
        return SAMM(address(samProxyFactory.createChainSpecificProxyWithNonce(address(samSingleton), initData, salt)));
    }

    function createGuard(bytes memory initData, uint256 salt) internal returns (ModuleGuard newGuard) {
        return ModuleGuard(
            address(guardProxyFactory.createChainSpecificProxyWithNonce(address(guardSingleton), initData, salt))
        );
    }

    // Create Safe wallet with minimal settings
    function createMinimalSafeWallet(address[] memory owners, uint64 threshold, uint256 salt)
        internal
        returns (ISafe newSafeWallet)
    {
        address optionalDelegateCallTo = address(0);
        bytes memory optionalDelegateCallData = "";

        address fallbackHandler = address(0);
        address paymentToken = address(0);
        uint256 payment = 0;
        address payable paymentReceiver = payable(address(0));

        bytes memory initializeDataSafe = abi.encodeCall(
            ISafe.setup,
            (
                owners,
                threshold,
                optionalDelegateCallTo,
                optionalDelegateCallData,
                fallbackHandler,
                paymentToken,
                payment,
                paymentReceiver
            )
        );

        return ISafe(
            address(SAFE_PROXY_FACTORY.createChainSpecificProxyWithNonce(SAFE_SINGLETON, initializeDataSafe, salt))
        );
    }

    error TestRevert_moduleNotEnabled();

    function enableModule(address safeContract, address module) internal {
        bytes memory cd = abi.encodeCall(IMinimalSafeModuleManager.enableModule, (module));
        sendTxToSafe(safeContract, address(this), safeContract, 0, cd, IMinimalSafeModuleManager.Operation.Call, 1e5);

        if (!ISafe(safeContract).isModuleEnabled(module)) {
            revert TestRevert_moduleNotEnabled();
        }
    }

    function sendTxToSafe(
        address safeContract,
        address sender,
        address to,
        uint256 value,
        bytes memory data,
        IMinimalSafeModuleManager.Operation operation,
        uint256 gasForExec
    ) internal returns (bool success) {
        bytes memory sig = encodeSenderSignature(sender);

        vm.prank(sender);
        return ISafe(safeContract).execTransaction{value: value}(
            to, value, data, operation, gasForExec, block.basefee, tx.gasprice, address(0), payable(address(this)), sig
        );
    }

    function encodeSenderSignature(address signer) internal pure returns (bytes memory) {
        bytes memory sig = new bytes(96);

        assembly {
            mstore(add(sig, 0x20), signer) // encode address of approver into r
            mstore(add(sig, 0x60), shl(248, 1)) // v, indicate that it is a approved hash
        }

        return sig;
    }

    // Since after each contract change, its bytecode changes, and thus previous proofs become invalid.
    // In order not to change the proofs in each test, we will make a default proof.
    function defaultCorrectProof() internal pure returns (ISAMM.Proof memory proof) {
        // Proof:
        // Tree constructed from all Anvil addresses
        // From: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (0 Anvil address)
        // Calldata: 0xe75235b8 (getThreshold())
        // Call type: Call
        // Nonce: 0
        // ChainId: 1 (ETH)
        return ISAMM.Proof({
            proof: bytes(
                hex"000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000c60000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000225ffc20c4a12e77d7cfded0b01bf497b700000000000000000000000000000000000541a7f24cc11e8c351b38e890d2d60000000000000000000000000000001a723b2c5878933e1b7ef429690023a4f7000000000000000000000000000000000018715a40f7fe2bab4b17d1542f24ba000000000000000000000000000000d362692a5d537566f6d4cf1ed6bbc44d1e000000000000000000000000000000000025c52a950fa73d568eba4ca8394a1800000000000000000000000000000041fc3dabda98dd1cdbcc9846bb6ce2a271000000000000000000000000000000000003f37c2615e3880cd6f5248b37c807000000000000000000000000000000e44092f5cc60dcdf028c1d56dc0e5db98b00000000000000000000000000000000000d239e146a07ca3ba7898fc6c6c2470000000000000000000000000000009bf947841ee218697bdc5bbf90a554f3ad000000000000000000000000000000000000c9176fdd302c1753c099735dcb1400000000000000000000000000000072abe7d9dae9a9acb31d1182776eb51079000000000000000000000000000000000017bf6d1c8729dcd47b041467d484b1000000000000000000000000000000f4bf1b68ca9bb82df256a4cb764f24e6b300000000000000000000000000000000002b05cf9e193930f92c10db8785dac9000000000000000000000000000000aeb948c66e74f1e1a18ad8df98470a3e64000000000000000000000000000000000028327772b0988e4fdcd9475dd5ed3500000000000000000000000000000097710b2c3d8e6e0aa5d2f8a42d8373ea630000000000000000000000000000000000039993d08dd14926516a0f6855e0780000000000000000000000000000002a9c03c58797281b08580da8401ae097f40000000000000000000000000000000000136fae9ce20f48f797c7ca15ca1d3c0000000000000000000000000000004819225bdb3ea2d6673f9d6d6674ca4c43000000000000000000000000000000000002a23a294446ba958856b87bf88bde000000000000000000000000000000b583e2f7e0cbbcbdb68c7e286d063e490200000000000000000000000000000000000f7c2b74a54810506eb49eff6808d9000000000000000000000000000000c8a0b318a1c574a8e30f16c73cba8bf01500000000000000000000000000000000002935fc61e3b8197180e356dd09f90c00000000000000000000000000000055259b9ddd4e8e2faf3e548e10d04500450000000000000000000000000000000000229dec3ef70ee35baa4efbfa8beef7000000000000000000000000000000850f682b095f230f34590b357306960e75000000000000000000000000000000000015bf54d8f0c30998f7961c47cd1d412ca4124642c997aedd775252afb67991457f60825c10b8a482d7bf07991a23f903c03c2c9e68087adad8f363d1cadecbe2b487c61da8b7ecc10a368c56e5dc081404e8d3774a3e10167501a409e6855a636b4d7c0ccb4d2490cd92aa8cb768c01a59b7e2fb63f5d55aefa223f53d2f39363276eda789c9e7d9870023ee83c03724afbc4703b7312841f177b465019b1fc2353da83c938e5b84800d5a85bf460e117e1ee69a209f56b55e66b1dc9d41d1d7d0864b39939a22dc4ad7362e7f3fdf2dcf8efc7444ae14e2e95369475eb35f2f3ce9982d440a392c97318eceb140661bffe75531b4ddfdd550c5644f0a66db9a42f3855b59eb2ca83b67703768895602fd3617f7e0e48750a588f37b6e351ebef1cfcfd13b842851916eb7aa85cc861bee4f6ac88f154fcbb675d82c7d1dbaae7b9079e6fade6fac17883f9c463b91128936f7e49e8d9272f080960c307a5d45b64e1f1c7f3a418dba011864028cd50524ec2f4738d054a79791291948d6df4b119a2b989fd682e4b6a6e9787e2371123d4b2b8caa7b692d1dec9938ef7c105efdff6a840e14cf0247866c45caa3b619317ae04893b2519d0a2af5a04f2cac6a04ce50137e34277c4fc6310a9bfdd92c3e5a78520a8bc35d74f4293af1fb8510c76bd333453328417532375b1735481a0ab7c9f1b47752ddcf346980970a85ae470ce40eab9a76a14c071ff0a62a652c67d5447a2c38e81dc904d11a9058dc3836a1424d10a5aa96629cd1de1cd2b92d4f936d32d5e9fa70eef536a77aab44132f1d6ca2b4ae8ee7f4a7a119ec8e80019740b661b587555696da75dc958ec185e0f56f220e52a1fa5ab666fce55ea41517f68453325a895c1b98fce66f1eac2a596858cb2b49db7764aacf89447a6d2bdf4f4fa03edc1b90f58c36f1a7c0522222554f6576878f09d9b83f33064d4903abcf462eae51206adb942384ad1ca53e8abf3f6dac5d63a59bd570105fd9df20fc942e544956bd31869f64d3aa92879153a7e2bd4297ded6c73543505efcd50f97669f3f9779c345c61c29ab6d941b333a5935c5424092a84042b9d104d67f18180397bf56af47a436607cdef6a527b71462f0ee7b0aefe819aa0bbf53a6eb021f8ea7bb5d3d136860e35d391ef99b9dc4bb7a9c711267539ba172accd41851b1ea1d6bb476b0e76c6c33f969c95fe51eadfdbe101097803331a88e44f8552295bd456d1576f3dbed619e3e8c99f594960dd1ad4a9def2886defa9ec45d0c12ab4bf5fdc0ff2bc4075267457c3899e6377223ca76c8c369ce9929a1a8747e11e403dda942d48f8be85e666a1b0bab22f8f340639b76cfd127d8ce67a6a75d323b3b418b5eb9d63adccfb5f72c973896660c45032e6e0293e6e1d86fc53b85a12329ff2c2cf09d7c596ab2c2df555e2cdb390a3c72bd775d7ba059f757821fb024320f3a40355c5d08b0578547ea370633f2916621476f292c40770b41cccda1ed572aa69fbdf0ef3effebe79fc3c0551e247fe7c2a1d507b1642dc0176c19d0ea9912ab7e5223805ad79cfda3de617049edd073b0c49965d7c0362744873cf2be28f92e0f7bcbe1a4f5ae937db927244d2673e9c65dd56166c7c56edef78f020bb2c93d13f93ea5c324b3663288863e5778d003c6a839465d771350071ade301495da68104b6e91820d5d5fc035c524dbad2270fd31eaaa73e346b952166780b8a676d8119f7b255e976c1af7b24be6addba73b9e4d3aeaed0795252a1f4b228c80d7dc1d9a05178e49cb50a211ba1c1a19a965d467b55dfe4775f808153b407fb210197f4e1b70db0f354a797738e12dee2f0f86da63168b9a4f0d08119f4117e18f72a43c32e1242f89ee9ace57c1820afe0ac1c6d89728e283609b4ce511352bd586c5d77ee88609624bedf13805708679178c7206e7ccbc19ff71920132e6359c2dc5bcc41dbff932a2841bb51220bd6bcc1d6687563bd1405d0049cd61d2f0039912609bf4129a68cba64ddf71c46bec4d1ed7473a11d8ff5ab57ab7a19ff4294674220ff6d05f053e79b6f7690286fcde19e5a8ed444c12fa73a5cc40d07ad2926eee3d6c9e5c9d8510f7f6d436c660711e7158ff872f5f369bca20b09628186973e0a6f53d409f44af83587942c0bb5961048d4a17a36c23e7ea46d260b983cd2fdf06ba9bce59c2e30d32c5ef45838042e396986ea9efc6dc9563a304fa85552f1330501794485e55ffe1cd7def6f7ac185e6da48f7a716d0963e21aee55f20ec12cbbf27c1d8da3b13f0c3c5fc187ae1cf3b7f866c1042909eaa0119b1e9eed09aa1b06cbb9695e2ed30eeb6dd474646313f598d3c94429620d832e935f37672b0944a059be024e93e38047e25200af19aefdba4f982c53d9bec92c45eaa47dc07011bef4372a6b2de24554870d12420c3792862e4fce807b2c0f192204dab6f40ba6ff452e3baefaf9901a00c37d521eae2209a9a2b795da2d38139fb03216a302536c27896ab284fe1a79196bf4c45ecf5e579fe8311c7ee02620f85af37baaa2711a92a53549d77949ac8fecb0c14bcb1bbc526b84f742310c278e8ec36352c4264741ec0488370d8fd3e62a204d726480f14388f4dd1237391537aa9dd87e701749f44aa89afe3aca169bc369af05450dee4ca1cf94a2ce171082c99674fd1441ae080960cb73a10345168ca871a7356cba2956ad81a8ce2a01aacec567b8d96464633bebe6c2cec37a6be1f1beba96fb8922238d80b066a1300cb49c52087ab849c399941e69918ee2639e6e6a4fa4d48149dc690ba22013075cab66ec1a6ba7a3586046eaf7be44f33bce8243b2ce092091f6c0ad727ef91d71d88c2daa0d7afb120fe16d86f754335cde59fe665e83610a825a4b1e84150206ab795cb8d0237ac02c30ac799330de4aec70d048ca1b1a6d3e821f090aa51ac4b270ccc6022c5dc9131a8bc0aa6e6d4028fd0fd0a8ddb7de86ddac397a6402ac10b297470317e6492667e05bfef36b443dcf2c7c0b44e43649bfa58e2eff1d6c8c57dee19b44de9126f50fa1810bab1f2f9c6a7ba6f1f626eba8c813d2c517530a5fe576519d36c64e1fa17ace5b6e2b4c227f0c72f7b0dbae994a064a5f2b3728068eaba37aee23b74eec04c30c2ba42c3032d2356d914a6ffc9720508d2482a8f593d97fb063ecf30dedabc71da5097c0d579a8f1e207de423d2186f3b264f1f33cb6cdc857739a2d88b9bc623f1de5c28392e6962eff58b763b55311d1826837106144c86c3568401badb812d8128bff868684290dc19b1cb0ef6c9bc018308562f2bdff9f81139d00b36958dffa5fc8aa6836f35d2c7097cc2bd1e5f1f30ddd8115158fdcb8ca66cb153ee56b0112fd3baef9ef07b7c23805c39f90f2c05f7ab514e142da89952fa6393f64bda7d1e13f042c00df564906e4d128b5d2aba081c22dfd9a0a421319ae74436046a6d4ebe1b3f6ca77eee07793365b93c1430985a512f69cc77bc5fcffdf809b3efd9b363e1e0dc2b4fb677ad651cb82d13a1974874da25012135d3c918acca39d697870cfce12c7301e96d0cb411236c22a91d47712c4d9b0cb3e542e1184976b02f99d0f0e125546d20c717596e156d130dc14bb9d156a9d1a638aa41ab658396a2f278d1f442cb4ff9343b37a7847919f530dddd2f063697b72b55a52ebeaf49a850bd8dc491b878648741854ce8b90a1c232b68340f8ae6968ca592d84551c3876f7d206e7134519ad99e4cb7ec2e2c685fa99071cc4c2e0b82eb0a11079e9afbf3d074be47e87e87b31114de248a230029e039918335ddabb54d4526ed4a3ee7036fa04254ecf5aeba013c0bb8f61833b32a165d82f092387a7f8815b8d3801b65fd31dc13cd87bab35bad77f19017f3f875113d0db128953d11b9c3dcb0bce532b706d2a42cb4571a5f61461f5c1b1c85b0a01840f6588861317234d876f2003b1c4b63d283551fe6ddc7aa29220cd76c76ccd4120f198039fa0176055ee40dfa0147c1afe3af068b844066f2b12eeb051c5f62f252cbf8dd87b1ea653b8e5183a1eddd63fcbf8c2aba3d50d733074c238999800fa00409b8c33efe26aa253df2cc13d61cb5ae41478886668ba02b0871122c0b260cbeb9089fd996967fd62a4142aac7132a576857c01758aec00d9e9580c913ce9a7a896dba47488b779ae93cac29c311db9600a15fc44e34c90d0cdcd286a200dd1ab110de9a40139a4c7268743717f84ca1551789c2b11ba513c3ce411b62c70c9551f6b544050de83a33a791c5a777bc0905ebac347fed89066dcc2715b0e504de36ddf4d4f0d67e033f2f89292f4d4d061c34a03cce54ed1a2dabe4d46a34e42dd287c174e42584b8412e079018035a6aa9ed4d7b8b06f10148ca24b798d7f43b3de0b42d5ecb18486d1b8dd1598832e5167bc88122f33f094d658f9689b308b7d510f0e73678bc0f0b24ed1aa0ac279b018da836ad80470e733fb5f63a9157b86c06ed333750a2ae17144f2329241cacf621c1256cc1fc0b35d05190ae8bdff656a531f468962a1401938127697559cb941c08bfe840e80ade00729a4cefd11d47f9a684b83f54bb602d19952dd5399520d1b8f84928af2a62f8cd9f1edf878c05fd7c74fd333c4dc1673c101657700a35bf047e80b9330e8855c40192b6aa403cd9060a972b38b289cb54862fda5397e187f96a31a13e01f9c7c95328dc6fbd955d972b1ca82a6437a8eb8f99edd49a8d53aeb4727e2716803da01da7a03e8cbdbf9aebad15f316493c46336743e2b25ca9623a53670b1d9e598738bd21e55b9703612461d8c8536eb902a0908948dea4997f084fe8212bfbfe0d0612871a8f3a723ff6a16a46fa40207fa6dcf72eae750dba5596588c2cd18d3c9a9d543e418a0f4046e8b2d991b09faf011e15850d2da793b201b85c1b7474a76967ddd324f346d40a7aca9a37d01bcddf62aaf2cd19e59afabdd69f18a07a80e9023e61ee65fe442b003c1277a4d155b147f8b90efe325284198e1e285a2ce0ac338891c16af3fde23c78c4f1a6b45b10e683873a76b66f124f7da327b03b931cc5510dc84aa0508daf405d3b6e3abde20defd7f2f4b0ff8d3121e10dca3bd0810028311b511770948bb60aae20ae64cacc7ceac348cb2ff3c3f6f010dc6bad414a73352032fd62a47a0e12448ba890dc0ec4ffb8cbc5914484983d1bc011a7076fce9d45a3e77b1f632322b93400bda1215ab1061fbd0a9bd3bbb21f5dc018f620edbb594080e88dac456310475e48ce532fe08c7c91aeae756fee16c39509f9d1a63d18cfb023cd3953d9fea99aee38579bdfe0c86535d4ffaad81aef836f60bdb8ea6ae8f610b4c465aec553ae22c0f4066b7ff0810fd26a77621446198c6ce52e3b382e1f15e2b8f4c507987da8f1ec4cbbc111a0635c1d04e31133798a7beff7f85bc2c421be37bd7d2e43676bd12409acbe6d33b831934110220e34bf8cfb5bdcc7385251b376ec6c501fb591cb5f358becd1b7636c83e55c07aebeaaed237dda763447179311110cee7b6e613391a6c40e50c778611f08b52686054cb24edeb6b039db00c3bb8a14ebae858a497ae77d1cc008e800fc3e1102eb2d7562aba78366ff8c1c9b38c233b234ffed052c7c0dfb8fc3e0cc1cee892a14a2e836cf4ce0530bdee0ab59575067164bda078973ee40c994ccf1fb3b85257abc2cfe0e828f2a7e03dbf5415b7ddeb964386e389ef787cf65dd87a8da710d86b4e68a0f006ae947e95b7c2408631777ab6d3b014a9661b833cc3fad79811f153094ce2e58ab97796cea2b9a1a8574b771392b65d44b9277bbb93c38a9512c92bc43e858134c560260351b79fae4b212a795707606a4266ad884277646f6057a876a11b8d7f9f1998ccb90d544b36b545773b93c65fa8d27f8e1ba91c8292a46b38395ff2338fb0d42b166fc688bdf0a30320eb83eb42a5745dcf45e3fcc0fc3a314bc90af24bb713173e09c0f98aa6b3484ed8c58595257973a9537f99e2549ceedd6f4fe8c1990e24b4b952a1c3a188c278dd7a1f6717b7aed32e65c9f0fd9c66f8cda873ef4105565c739d6d82e8b46dda313f8749b96c1c433434080211155789718963094996ddf462e902f162ffcf69e9724147f0a5685b262a2b81d3a018b217d4ce39b0734a290ffbadf2438a82c763da2c7d8e1caa566a5ffd711091c02fabf2dcbf41eaf728f0eb78bea88ecb723985d84294f50554434fbb12c49a5256c0e097874d28cf0799cdd7fff85eee68858155b97a0273245dab6c227ed66761ebe1555e7b81830c5887a54dde2c6f6d24585c62adda8de80fdbe241344764c3bcf91512f8883169df381aecf2727a02e95994badc36e07525b04032fa64b79ec7701835edee88f5115af3827eeaf8335e2e342de5c696dbfdc044618cde9f45049d83c06cc60cfc63e42986dd4af57f73509abb90a7c808ad276d900fce3bc202d6c7481c3f8320da2fa7abf8b3b99bd6fdcf65a4fb16305b11a2a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000263d78b57381e331c741012ce157a23421ffecfa1eaa5e7a8500bf83bf822d74258c44aef35beb7331eb2f1a72710924aaa60baf511b9c0ea5a7c906e9142f4a2d1aaad0671a22a8ca5af5f0ed41f26dbf5c312afb5dc8ff330040fcb0e1c02f24fee0431ed01fa83f090519759c68c896ab874c4e75bb3d8d64dd93e3731b4e0f78140695800ad84ebbee903ce70a3d1b0f0914ce57c384e8f115128d82436c18cc69dbd0ec2c70f9acc602dedae3d1cb10b64cead172491d61871d019bf930179ec2efe22714add6c53bc7c250b48550ce74495a6952ce7e7f60ce910bd80f19a0edf45fe9ca6d960502aab5cc6dd2d6302554928dae4d67bdacfc9e80adb60b81142e0e1290085c6fca8123a3b62752a73ec7d984c253e49f552b930d747d2272d055ce78ef87bb90f47adbbd92fd616bac2d11fa56eb832ab92b2bd5397904edaadc9f8a2e222226441324d95d32ef83d579a7bc742893930662af5efaf80be11bb53fd5d2b55ff8c4eca5b9380496ba73373282e6121b904e059a0069d82fb3bb69e052b873322f63cfad1edeabf48c53b200bb401c92c14731747ec6aa116fcd6e5cbcf7bdef1b02cd9ba198384210392f247c853e736f5813f458350c0c15237428c1dc61d545b71cf5f3be4bd61bd96bdbc4e5199ed145262f1a4db8101ecb4a3992128b48b682ae2d13c485a1ccbfed083d67b9bc1d8a5d07b5081809ed9a2ea14b50aa8cd25d32b40a3c5f92940868ccbf6dc228b64a83cc0685132cdaa20c09d265f13cf157a7c4b83d3520079c10b61ce3c1e45be366c71ce4db1f0b1032627b4021ae884a5f513692297effd01dedf762423061e5a541c6767529cc505fe5388d5e56752d982916c8527a267e494376363ec634b44ee4f415561f227039f42886f02255759a5ecb2536ecc92f889c49145fc4638ffba2a11e022273925629156d0fe2d878746bc2be2905f577988d8c197ef8f9183ac54d424825567b14f033bed857feadca7eb2ec1f096ac9ca9b4baff154dd03a33c678314280b1ec80f6616622097c3b74516c52481b2f6bdc9dc26296c77300d023282752f737e2a78345773ea3affa6799aaf0cb7099869d19660502926cf14027ec59701000734203f0261aa58ba544c7ab4ad85c4f5f2d6c7155d06c0a72461653d122b84ff05ddcf56ae651b56ae9eba77e731fc62b9373a2b9d24243b237bbfac0d00babab25aeeb91934bc8b099f687ecba77478f43f3c70304ccae38758c3a1c30223f815563c505e2d54905cf051073ba59316b311d12d00d10e10ef7b1a99360b717e124797ae15bef3c6f538afb20ac814da944a0151a56b80617cd512f99612abe40258c9187c66b25d2ae41af5d82e87d047c8325858ed254914863da8f52be134c289c73ef26c25142c2d50328b673c47a9a5839417d7553413b4f58e8f1474e3a1a85ef4523353008ace0d493e81183e360eba0d9f4bb4bfa857edb8ab22d4b4a7686a2702a13e17104a954ae3be9d0984efcf020be7d0bcf700d9a7bb218f338f0cd29eb17093a1753f8e150b4cbc448c368d78d9c65f21b287f4c54727a76c49f0b6a091d55035c3ad7a335a16e6b4f23eb9be42101e2144ffe127952013643ea91f7e5df255946e59d193312146edc14292313052038eac6a566ccc210ed04555653da08aa0b6f5dc96a18c296c7fa425cb31e538ba979b8b976fb4139f00819989354f8b416a4ecbe12b27748ce86dfcda93ce214c9cf615159b6d004963f4b08a34fe3ed41cbc22fbb91d87696a849f451e394a3e8e8c1717a5b21483ca99f84fa20757f13408d540c051f1f39b441c0b0b2596e9ecf88d3f8d601600194b1ed3704eb517642903fb25214fe3fe3be24db6c61a90977d899834cc21400155009876120da3e9517d56082bb12b3ec5f3023f32865c9b80d0f27eab22da07e9161b10937f1f82def99ccbfc860c96eaf6f93c06b815c753f0eb92b3"
            ),
            commit: 0x11847c6ec60529a493e99bc283cb5d91f26bab02a785ea12a71ea2fb4101bf16,
            domain: DEFAULT_DOMAIN,
            pubkeyHash: DEFAULT_PUBKEY_HASH,
            is2048sig: true
        });
    }
}
