// SPDX-License-Identifier: GPL-3
pragma solidity 0.8.23;

import {Test} from "forge-std/Test.sol";
import {SAMM, ISAMM} from "../../src/SAMM.sol";
import {ModuleGuard} from "../../src/ModuleGuard.sol";
import {SafeProxyFactory} from "../../src/Safe/proxy/SafeProxyFactory.sol";

import {ISafe} from "../../src/Safe/interfaces/ISafe.sol";
import {IMinimalSafeModuleManager} from "../../src/Safe/interfaces/IMinimalSafeModuleManager.sol";
import {ArrHelper} from "../helpers/ArrHelper.sol";
import {IDKIMRegistry} from "../../src/interfaces/IDKIMRegistry.sol";
import {DKIMRegistry} from "../../src/utils/DKIMRegistry.sol";

contract Setup is Test {
    //////////////////////
    //    Constants     //
    //////////////////////

    // Safe in mainnet
    address internal constant SAFE_SINGLETON = 0x41675C099F32341bf84BFc5382aF534df5C7461a;
    SafeProxyFactory internal constant SAFE_PROXY_FACTORY = SafeProxyFactory(0x4e1DCf7AD4e460CfD30791CCC4F9c8a4f820ec67);

    // Helpers for tests
    uint256 internal constant DEFAULT_ROOT =
        13478250241025044241834632636828135155416924205892387731890373634766567630611; // From 10 default anvil accounts

    uint64 internal constant DEFAULT_THRESHOLD = 1;
    string internal constant DEFAULT_RELAYER = "ad@oxor.io";
    string internal constant DEFAULT_DOMAIN = "icloud.com";
    bytes32 internal constant DEFAULT_PUBKEY_HASH = 0x17655f0139cacecc80f4143fd28e7107ce6038374ea9d5cfcf5d3fb5ce0086e6;
    address internal constant DEFAULT_TO = 0xdAC17F958D2ee523a2206206994597C13D831ec7; // USDT on mainnet
    bytes internal constant DEFAULT_CALLDATA = abi.encodeWithSignature("totalSupply()");
    uint256 internal constant DEFAULT_DEADLINE = 4884818384; // Tue Oct 17 2124 05:59:44
    uint256 internal constant DEFAULT_SALT = uint256(keccak256(abi.encode(777)));
    bytes32 internal constant DEFAULT_TX_HASH = 0x09b086d54be973c0cae8f289b9a308969c3a0d336ba3000651cffcde84ce5fb3;

    //////////////////////
    // State Variables  //
    //////////////////////

    // Safe
    ISafe internal safe;

    // DKIM registry
    DKIMRegistry internal dkimRegistry;

    // SAM
    SAMM internal sam;
    SAMM internal samSingleton;
    SafeProxyFactory internal samProxyFactory;

    // Guard
    ModuleGuard internal guard;
    ModuleGuard internal guardSingleton;
    SafeProxyFactory internal guardProxyFactory;

    //////////////////////
    //    Modifiers     //
    //////////////////////

    modifier fork(string memory env_var) {
        string memory RPC_URL = vm.envString(env_var);
        vm.createSelectFork(RPC_URL);
        _;
    }

    modifier enableModuleForSafe(ISafe safeContract, SAMM module) {
        enableModule(address(safeContract), address(module));
        _;
    }

    //////////////////////
    //  Help functions  //
    //////////////////////

    function setUp() public virtual fork("MAINNET_RPC") {
        safe = createMinimalSafeWallet(ArrHelper._arr(address(this)), DEFAULT_THRESHOLD, DEFAULT_SALT);

        dkimRegistry = new DKIMRegistry(address(this));
        dkimRegistry.setDKIMPublicKeyHash(DEFAULT_DOMAIN, DEFAULT_PUBKEY_HASH);

        // Create SAM module
        samSingleton = new SAMM();
        samProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataSAM = abi.encodeCall(
            SAMM.setup,
            (
                address(safe),
                DEFAULT_ROOT,
                DEFAULT_THRESHOLD,
                DEFAULT_RELAYER,
                address(dkimRegistry),
                new ISAMM.TxAllowance[](0)
            )
        );

        sam = createSAM(initializeDataSAM, DEFAULT_SALT);

        // add TxAllowances
        bytes memory data = DEFAULT_CALLDATA;
        bytes4 selector;
        assembly {
            selector := mload(add(data, 0x20))
        }
        vm.prank(address(safe));
        sam.setTxAllowed(DEFAULT_TO, selector, true);

        // Create Guard module
        guardSingleton = new ModuleGuard();
        guardProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataGuard = abi.encodeCall(ModuleGuard.setup, (address(safe)));
        guard = createGuard(initializeDataGuard, DEFAULT_SALT);
    }

    function createSAM(bytes memory initData, uint256 salt) internal returns (SAMM newSAM) {
        return SAMM(address(samProxyFactory.createChainSpecificProxyWithNonce(address(samSingleton), initData, salt)));
    }

    function createGuard(bytes memory initData, uint256 salt) internal returns (ModuleGuard newGuard) {
        return ModuleGuard(
            address(guardProxyFactory.createChainSpecificProxyWithNonce(address(guardSingleton), initData, salt))
        );
    }

    // Create Safe wallet with minimal settings
    function createMinimalSafeWallet(address[] memory owners, uint64 threshold, uint256 salt)
        internal
        returns (ISafe newSafeWallet)
    {
        address optionalDelegateCallTo = address(0);
        bytes memory optionalDelegateCallData = "";

        address fallbackHandler = address(0);
        address paymentToken = address(0);
        uint256 payment = 0;
        address payable paymentReceiver = payable(address(0));

        bytes memory initializeDataSafe = abi.encodeCall(
            ISafe.setup,
            (
                owners,
                threshold,
                optionalDelegateCallTo,
                optionalDelegateCallData,
                fallbackHandler,
                paymentToken,
                payment,
                paymentReceiver
            )
        );

        return ISafe(
            address(SAFE_PROXY_FACTORY.createChainSpecificProxyWithNonce(SAFE_SINGLETON, initializeDataSafe, salt))
        );
    }

    error TestRevert_moduleNotEnabled();

    function enableModule(address safeContract, address module) internal {
        bytes memory cd = abi.encodeCall(IMinimalSafeModuleManager.enableModule, (module));
        sendTxToSafe(safeContract, address(this), safeContract, 0, cd, IMinimalSafeModuleManager.Operation.Call, 1e5);

        if (!ISafe(safeContract).isModuleEnabled(module)) {
            revert TestRevert_moduleNotEnabled();
        }
    }

    function sendTxToSafe(
        address safeContract,
        address sender,
        address to,
        uint256 value,
        bytes memory data,
        IMinimalSafeModuleManager.Operation operation,
        uint256 gasForExec
    ) internal returns (bool success) {
        bytes memory sig = encodeSenderSignature(sender);

        vm.prank(sender);
        return ISafe(safeContract).execTransaction{value: value}(
            to, value, data, operation, gasForExec, block.basefee, tx.gasprice, address(0), payable(address(this)), sig
        );
    }

    function encodeSenderSignature(address signer) internal pure returns (bytes memory) {
        bytes memory sig = new bytes(96);

        assembly {
            mstore(add(sig, 0x20), signer) // encode address of approver into r
            mstore(add(sig, 0x60), shl(248, 1)) // v, indicate that it is a approved hash
        }

        return sig;
    }

    // Since after each contract change, its bytecode changes, and thus previous proofs become invalid.
    // In order not to change the proofs in each test, we will make a default proof.
    function defaultCorrectProof() internal pure returns (ISAMM.Proof memory proof) {
        // Proof:
        // Tree constructed from all Anvil addresses
        // From: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (0 Anvil address)
        // Calldata: 0xe75235b8 (getThreshold())
        // Call type: Call
        // Nonce: 0
        // ChainId: 1 (ETH)
        return ISAMM.Proof({
            proof: bytes(
                hex"0000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000004f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000068a25f8cdc2bf48ca28412f8b7e85b0ba1000000000000000000000000000000000018c9664517eefa6da2881cde4e3cbe0000000000000000000000000000004df7e0440c14899fc6a0cd4730b907df3f000000000000000000000000000000000008240a225ab1504856d505965b70820000000000000000000000000000004fd8c0a2ea476a4cf8569ae8973035024200000000000000000000000000000000001d3745e652b8755e685e06118ce936000000000000000000000000000000d5acb7313cf1aacabaf704d126ff5add8600000000000000000000000000000000001a8a9cee8b49946c003859d6874313000000000000000000000000000000d5aff8bde9504cc145b9aa055cebecd800000000000000000000000000000000000012745524cadc2dda33621492a95f010000000000000000000000000000000d271e0b0e3d829bfd5255342c70a625dc00000000000000000000000000000000001eafa0b8675dbb11cdebccf3680b990000000000000000000000000000005cdc405de17b2079553566670988f2786200000000000000000000000000000000002a28d98d6d081dce1714b84005ffd90000000000000000000000000000007c4b0c6766d5b916b167aa0e94e6cf4b500000000000000000000000000000000000011971be18e3fa0d1d0ed08698b83900000000000000000000000000000062f00ba00877a3952669b7892bc55ec28600000000000000000000000000000000000add31bd8cccaa72bc866ac4de5bf80000000000000000000000000000004752a13fedfb71ad1fdea3e291df1c9ec400000000000000000000000000000000002fe34996bc539ecaf7862a3bbc17d7000000000000000000000000000000d28a6d13b99e978a7a3bb4adcda2ca382600000000000000000000000000000000002c15dfa647b386f34ec60a26718d6f0000000000000000000000000000006ba082136e7d857215bcefb822f345f6a5000000000000000000000000000000000000cc08f67bda0955cafa0ebc2dee40000000000000000000000000000000dd7fe436f2b32e2a690376dc5fd3a42f0900000000000000000000000000000000000060a2abdff3ac86a4e5f29dd3d1db000000000000000000000000000000b33d8e6be130e8f048b3f2bb02658ae41900000000000000000000000000000000002fec946171346c686f9521a4973dda00000000000000000000000000000093561efed07dafd079b5a867e0f07099f90000000000000000000000000000000000065adfe2ca153b0fa8b1b0abac467100000000000000000000000000000040cc61948805c20cb508d4b6979cfc759300000000000000000000000000000000001dab9f3eda28a330b4d8603d4c648220573534b388d6154179c00bbefecbf3f9961dd4b5ea0d775603fc594faaf0a4100d193e2da8ca1476d685aac2828c692e9dca73c3cf6319edddf93aa0550f5d17409cef6bbc04c0e01e222c62d4dd819b7a2204cf0abcb6c5ebd92cef56fd5427891ebd8e25db399557faead94aece7375dd6bddcb8bfdd39e194fb55e6994f070a85abe9810746d947d7e87e81eb9b0a5d0f3e788922e122018383c62235920bb2e308326542eb839199dade91aa67c57dc2f4753da9b9906e77d2dcd3b40f2258a5a1ed3cc1fed72fc3f843f2f57da9081e69abbb3dfa144030dc7c79d6620834860ef94c81a63e337c256149425a0c0e8f36b876b3d56b53c3e1a985043028f56431b3e9cdc44d8377ad05b24d2e598528467d02f6d07e9c9052f555342e20596ef9013b35554a5e8506a9f4b6c3304f9dfd9454093cf1a6ecbd0b22b3b928c2fc2c06cb0eaa5d8a75c9a896a2fce6f7b7a41346bf046759c7d90b32b6d8052b2e96c1e25b2dc943212c4d4f525545715b2aecee0e74f6e897804d671a8216ce9e01b2724d24f603bda8401e1efbca63bb8bc34e7e39b0923411f02fc0592b25d14192048b2348cc3a2077ee4956bb54e23d5402642a6d1365048e6f0b6d0f53412e6000f0da1d2cc39517917755957c41da4fb76d0cbf9d938b79db6fad10c155b61a9716c4864efe28de8a148a6d37d138116e07f96029dbee55382c460b37c271918544423a41a350ba9eeee43a9e13c3d1813df910a094456e8b949f098c637cf6263c7ce7923798bf53aff3b994cd88d38a3e6161346d42f7b9a6382a84444d074f1bb68d7937f1737558e52fa8d5c3d6674e07919aa37296b8d14d12e5590da1246bec9b9488886bb210782c7b4764b3859ccaa702d466ebf0c16a0a0cc4f0937f233e8d8c0279ac811b12e64b52180b52731c4c806a1e218feb911b76c3d3977e5d979270a50e9c4aa1a165413c3812b61483690e7780724d1f031d12775e1fbd905bebf792c1358c86a8ba5add355c0e28d946ef4a2300476bca276134d7901cfc617534e9c002469b2514e643373142fbacea636293279e0bfd20b63fdf4224a30c9da12a400e3bed59ab721ed8ab6e720908184a6fb8a6d4e518ed459ad06471c6a048ac2bda4d8322e92d38681e755bef6519e336125c1357210fb1b29b78677889f264f9bf63b6fb1adfd531877e20cbab691769a86b7a562a95933b2a93126867fcc68ded096d2438f78507ca1d88d080f390e9eea60fe70bb917db9288d3ea1b65ff3cb1d4bbb7ec827cb2c14b5b5e53a361e78e29c4dd04f06ee5f0c2ec9090df46224bb91288252f275b3739361ef1b6b74db5284c29132d4ccceb2914d148c4b131d076e5be5af931b634b18fb13c99295d18b1c75e047d4f55a568bb33184922b92d7362240eff4e8c235e1df72732436352174c76093aaca1d456f94f274ada4efc35c229b0c635ebafa9cd69c9cadad97ec86da12878405d48f298d729389374dc8792a554295ef10cd03306b543049ceb44e23b1509b7a767bdf41b26632eb04e178c6b1ffde035c97c3a17a9b1a66da42d4f542941a9566bba0780ead7e206eba607e8a3c632f2ccab45ac7a438fe4536da85b0ad5d9b5e969acb1f8f56c8004d23a5063831ade8e1d8e66825e71c54886ad1c0ade57c9ed7dc3a42df3675a57f844c8c3327dafcac52d3af4cf2e3332458b8929a0fa29ecf2c683e49b8e7a57d53471f6caf21941d6eab4f1631e4781a9310f276f216d7a0de99dcf45bc729c9ed60bfff2a134042d2626871aad5b57c02aa62f977394a261ced6938325031f76cc971b833c1ba38815c62aa19187e518f58b02f6d2d652391e04b7b806f9c81d22d32f3dda735e79a0035f2282faabec17622291d0ace88b24e44b0f4baeb397337982f8f3e5836a53db9a4b9bcf996b58df197525084fe002da6ec2f0f52bf4f1785a5a2ebc043693f1dfa99a84346150b21270fc0e77597178dd873153310be2d811bcff10c908082ee71b907682f0340f16d5a546b2235b30f4911a2de395860627bdd66bc661ce25530527de9770adf0191f21e712b8fc248b9395e21cf4a8a08ddeeff9402815f3dbef231291339f0a07a0498d447cc6611754bc4c3acd477b0a9295b735467f337ef8361e8e41099223accfa09b221d23900a1d2e97ac274c9a98acb4c6a8ed660b3131958b2f9fa3187cfb400c99a788d3b19eb1851a853a3e91612a0ad942f5c3bba33c270a1ad22147d98a097e30a45a42cdad3824ebafa34929989a02603e8c05f6f5243bd4430ef01d710a2381bafc06130f038ba60189ef06aa0e8f451e06e095eb9ca0d5d928bbf3fa3c654e2510868e65a88fd8ebb8e7e34b0a2f5ad059354cb68c95182c2ec575030dd9fba0207784c964722d142af0a36cefa6f368eb1a93a1691a23061a8caafb1bb9f8dff84f72acc6da848c9c7673a88a0be356dae8f9366d13bf782b2bfbfb8d286e25dd05fd9dd91b4e4a04aedaec257ddc0a110e7974a88d1fd100d390e87bb62715b0bf105c004899654b64f81667d3b05fe37debe56f49782f2b382ff8792f29a7b1d80b10cb9563d9cdbde99f32b2442d4df72df782d6aece2b1d6f458b979717c7943cd4b42bd92206c7ceecc486822ecedfc8250dd294502a0f41daeffdf3f412667ad3a2a81cfb516bae5d31b3a32e7df8b996c617779212657b7121528929a47eb916357d3dd06be53c22fe6609f80acd21ace0cce05104e650cf11833c1a3bfcf37377e4b3221af719aa54163b1e6b4c0d51eb825daf16844358468d396cb431c0dba61c82de691229fb2e4a0044ad830560dbdf681b19e907a088422cc607e519f6277520c007b4b93c3f0efa8f0c046cb23eed2cef110682232e1a0dea2b3508dffd446bf53d891f53c3a81ce42ce75667124f3bf620a115e7a09be029cf3e0dab925fca47e235b1c187e1247e4475943862b9614203f7199b7cd0fcc9e398d6899da7eecd25d5ea121864f5bd89df4e0f757b767e2fd6005888407c36077e1b1de5c015dd804b0433143dcbdacd0f81e64b6dca9d2664ccaa962bad3c885f61b78677702a5553277b4ef3295452e8990e333395dd00d7a58032fbe9103e0c4d584937145e06a6364f717e3d0b3269aa36f36cb0ad260871f00ea17ec95c7c7be223981ca288de8a788265f2962be59d09e14eb7fb2eb0ea67d524673c960b1a4c288702c78db8c74501d293c739bd6a186601a97b2c585e756b767af18c0d4bd8de948da1ec112a8484ac187530496bb3bd0fa238290f12a27d38756083cf5c54b0b065123879323e68c440443503f287d3b98b3e0dc5b87b6c233a2edcc4063ffc06422267544f2539a74e6d4738b8b669503ffd159cbf68b96282d42c6746e0eaa82a96f144c5f04c43ffab57548762bfdfeaf21c50daae06fe7580131aa13fd5bd9ffd6be7fe38dd0bd2950503143b93932f0001bbe1a3903a247df68466d27c44116b3a609fc7611730f3c3776692bbec025b1935b403cfa06b002aa3bb12256b5dfdbeb234bb11ff70fc897daf8b9776e813179d88dd834902be11549ccbc5ce6f58d9cea0d61cbad2fcf5393dc217d147411059bed1e5eb9bd50f80f01fcadcdc9fe2acdac2b70915b24451c27bbb648f4818396a84dd3849c240c054c5d95fb19e29786cb3baa604d57f09e75287b2d8590dde23ef3823263c0a082300722034e05d49c76f52ad6c23f0479f835732bd1c0fae499f68e5b3f885ba052fabbb29122700331b5d9290632d502b9c0dfffaef1e4e8a456d20aba2ebd919a1f36f984dbe2159db98f306f297e92f2096b9404126b7550a1b69e75cbf6723e5d881b6321cf1db9dd2ca22013d4458f7606e422e12d82eb4492775c07dd6cf14aefea4170ebbe2aba664dceb81e7858599a11309120ecf060dd02a134abc4f87a79accff2e01e729089d7fc9ebc639076e8848dd0e1a7b8d685cbf8f963ab5ce852e3667e2fa463e32f391a493dcffd685cf4e5c289ee1ddffdc854b42dcc4ae0c7affb92ccb0b153f623ce908f7953db4453f5e2c80b660bab1ff58059e3da8a381d6d6d5fed4bafac58a430182a98faa08a94a1303de3f8ebf777a653f553b489616c6ae104f433c8c51e9740e936fb4be5d7d29fdbd3859209747d54339c81aa9938bd71ab90f21f7e890e4a37631c34a16091d7552efd7877f9be6e0e087aee0892448d14af0ff0baaebb635a650f64189ef1d14245c35eb49efb93351ee29c04824266262325f6f3010ef17a960b4e813531e6cd8fb1b015bbbb39c79ba591e7174f55740b16d3cbbb85724a573ab6baf762807edaa031a1dd256b70ced8c141ed990f10f5a86a60ca10de3d5e1869d74071d81eb3903c33175b915666a5c4b61a8bea48c527c0068ad130f978682100a3f062df9709332eddb3be038e09e85d325e25436be2f191c9e6914bf7db55b3f1a23447a468842ed8e799da846ca3a38cc52ce604909e467974a9bd240ff2149ee30285c54ae64d01b3bd983ffb9ae03af53a9e31cbc29eadfaf9c746a8fad31dc2a2687e74e92636028e6018193b8c37ef3afd4f2918142219a369c03fb41289b23b2d1a6e318f23c3a8169d284cf295cedb7b204e3b53721ad2c635c3aad948b2a9126dd4a4eb7e8dd9537b68193ad7ee8696090fa0ac5c012c66ba571eaf47511bbaf3e6d966eeef00e26006018091d592e14a60b1c6a24f825a287e8018b200598eb66d7491d199ce664a2410031f8360c9ed7f6d0b236ed58a971c50cbf1728420c166d0f664eea3b812e01b4e3babe3a94afec4896426d04f1131ec5de43188d9a75051ee645c49a895c3621df7df5e765b745df4185d05bfe0c5ad01e21132a107725771568f4294289977d7bb461324e17818794378484fe3245914f721eec77deabc125e58e0c9fda4a9e76ec482942dcd3a5300f9e8a08412443bb3b1b61ec64f08b1f694a4825497411a7ed44667505b29453a17ae4d35be213c6620be0ec84c5a03918e03522a993d857c24160625c4716974709d2f948085a176c2405454e6fed5813f0a59835ab88ce55942f2567a7d6b1f8b5eaae36509a72611774c84abdee16155f9d5b1f3097840af321e03462de8324abcddfcbb1b0c7890d11e593ea96c21dba8a672fb6d4b99fc0a5dd80c98866228e938f8b702892df2e86a0aed82d2846ed32d4e66a41efe1c64c23b4bade4eeaa5a4e6f2d42eca311bdc668331479f0b5767906c8142570f18214997bfb3f3bc397e1bb5737ec24009efe49fc9c11149ac7edb9e4de6f48c7d692e8f2bc03770488ce8a11e971298184e2de39a9cf4b8f35a622c8fd8d8a1444ef459a6bc9b02e3d7d3aa350296a40c544ca5d9ce1308652eaac77273e567740303562c2815cc8bc6bedfef43a1721c4a15e0b08439fd1bc25e3a391c4774f097341e758aea431239b1ff49463a0a107bf346ad3bad601c07f2db79ea20a36e8302095c80ed5454d5cf5ab4e1858f0f85e7db47ead2a749c7835fc48332214e92f2d117978365cc07c5c853bc901822a6f6b2cebbf65521a92a614a9f3217a701565c6073a1ccfba0a1cf269570fb0aa9f854104fa5653710cbf42a9800d8e185de87d2476006b8c6b59abb8f11520bb4c82b4c5e533b0512c7098e77d797a362b2f6be5dd82f5e9abb2995885d781b554f0bbd6e80c6476483f807e92b4d4383622c4ab46147afa6227201690d0e2d8f8804e8cad0855ac74927fb8064b3d6635851af47a883a8b54dbdada2466e2e5e7377feaced3ed25927483f8407c97e38de9131d0bc4380836331a6d5fe600efac67427b03460a8c303812729d48f533f3df1cb1a6970563ed3fe7f8b86600b100d48cd59b54302ea5fed15f974635e6d773c934bb3c09f0e4b128c7e2cf02dc8d7529ee0f60b707e959c12e92fceb0a4d0c959bc712128c144ab1b27a63222601c0308879d30e48227e5692c0cca2874448a791ab40950d8bc2a713c7ba21321be7efd84a91590e8d789b0ffda0471d9388d24d7fbf9099c27084539c5c212cd0b8d097f78f3bc0fe65d747be20f0e671ac5949f6ec36cdc2f16df0faf5526c1061e5a33060ab3884cdec3e71ee15fca073d811706f8d7ead8fb63f7693e2ca4039773264fde44f6ca51af9900244cdc12f0f636829a19bc4bfd30af92e41bb68911ac79b1ee2876d04a5229856025ca8a25792096dd6c38a979df8fbab92514f625c194a0b6fb94ecdd4369a2e08cd93b23c36043eb7694aa99254bd5942e59ea5da6d80141822e6c3c3ee38ace6d958499f4ed7e81d84741a4fd1f4d11196efcbb4b919a454fe28599907fe29ec4151e0acf025161d4e73efaaaf69d8e2e2823f1df67a4f9aa426422584e1e2716ca89aa921af45a7f899b40fbc522032e48815f82ed92662e0354d80257892967438fa062825fd5f4b0a7720ea765752d755f7eaf6594d923b22c73a0a31f4be5848b5a531f5ca18ebc5e8637decbe40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007aded617c86a86020ee2754de5592a2b089649641a4f9e33ae72f329cfe1231251d7af56b0da36191ff3eba9b0a08f44d13e580436d0813dfd41c8724e84ca8137ea30b38932d494194a1e711fd38fefac9533d372edf7b5dec7b2296fe8cc420389accbff2946434595955296fa3d924e9aa64b248a9c7e32e3a74206b7864149d0f78e2a53e59af3af80c6a60db712a1df6d4a2a460f4144c52adf4baa91f2e051021f10552f70de207b85c2f9e2a1ce08bb114be7687e9c7a04b2974fb8114942e6c428031ab70495a299357a2554fa68e8a8bbd5f46f39b99bd0476b02811f0c6528807e282c31cbd5d2e85cefc90939fb1e62e88aca8dea02d0843c685211229d9f5451550c2ca4c90d762ad34948ca0cfc022696962e8c752a5605b6914883d6c54441fce0e74fd19cb09ace5422af37c46ec31c376c308ddb2c99a512a0edc7d6e501b0a0ec32f3d62379e9ff36c866f37450a779ab134970f4d0d262a35a3341a376b4ebedab240a08f786c6173c6af1be2c179507c587b08a04f6e0369256247061f79e6e1250cf56db0f5873b511875747b59e2e7c18b61fe421d169e0cba85ce685e390c0828424f3b542f5cd7e379c15ffb3dce3df0d61b61bb2187839164ce5de4094ed1ce68833f6418ad28ceabbfa0a8691e337665934d0f229603eb0b0c7abf4763aa9370d53fe8808d555bf47255b9ed7b933c38fd1df106860d25b5d7769587d7bcabc0d45ce7d53c960adf5e79fdb7f36ad5ab27273319963a974bf11d1156cd7f70dc5a07e775b01333735a16b9a4bbed3896aa8b161348b02e8892c69d0ae1cfed311cdd44aa681866504a0f5cd425986d28ccdb961c20596f2ac8b7c8e93452d33f8bf5cc8e5b3a5d620b5438d022dddf441d147a11e4214896a4f0d3a06a8e1461143e561daf80ff0028379ab93a6132a006b31307a90b43a3f50434cd57f60ca9851b83369add44288f2225e96bb51f36e457200cb99f3813e63d277ab377eb4d6f928f55fd453130e3d80cda526eb3f5252bf718f850668be5c56f0a9aa40f10cf91fb7ab907095ae7f76642dbe6869cb188151d5e887e99d94bb99d68dc40578ec323b58d063d3710c5e0b279c918ae6b49371a537b52135fed53fdb87ef214e383d01b48195426603fdd094005e91f79a6cd04599117eeee4651179629c1104b4c47bc5cee0789c96a2d56daa5bbb59e851d17a9b259f8322d5278036bc1a4a288d926e3427ab3704db9fd974954366d688d20447b0b3f4075e4978adf4455319be1d2e5c0c3e2722e5a17b412b852e688310fb19340a3040367fd6f3200a66bc94b23f84886767654bab42ca8c528dab99f22011782691bfe2e168f5bf9f4b96e5d534e96ccac77481b386bc0a29efe948f0b9b8398f45080990658258226d64b3ba4159daff2046ce6d88ed846e5e2098b1a5c2f202e378e5c8c0609da1a3a35e46e971326a9d49ff916868422a21062a52e27885c070b86a748707c0ab7c643d812b7908c6c9fcb35a609239c7729ae8b163cebda7de189baca04db454433626ebc1a96303cad7dcf5c74a36c4d3c1c2f1df5371451ef3800ed7567598c02302d431c6f69684ffa636b28340febc14fa429fe1e5611d0af4a3b8439eeb82bfbde71573eae727c3c5875699287ca4501b82dca176ea32ea2c728859bc01705053ce02d93b2b4b008d0a584bb88c3be97c60b3ef0241a478459ea5501a99029f94449d55794896d0768b0c51236867b13330c2e840daf110fb6f471547f2c73862801d6d1ba9f0597d1a0a00f980012f8f7111b2f58d1848e56ea91c43bd3815fa8ea896ec1e32818bdb2ad838edfca275e288e566ea770730a9c0ff14d7b872acfda8e93bad86060c35a0ba3f950e3e5d61b4fa0e9e03ac79fd64d1e1a6cd25d553f7b59f70d44f22593ae86b7b9330b5a18b92aa741aa2b667228d63493330407147a457b03d8289c49c72555fed07a11"
            ),
            commit: 0x2c936e6380ad43b3c04447fa051c73ded12021843d90e2a4f05e69ecb1649353,
            domain: DEFAULT_DOMAIN,
            pubkeyHash: DEFAULT_PUBKEY_HASH,
            is2048sig: true
        });
    }
}
