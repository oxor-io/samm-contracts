// SPDX-License-Identifier: GPL-3
pragma solidity 0.8.23;

import {Test} from "forge-std/Test.sol";
import {SAMM, ISAMM} from "../../src/SAMM.sol";
import {ModuleGuard} from "../../src/ModuleGuard.sol";
import {SafeProxyFactory} from "../../src/Safe/proxy/SafeProxyFactory.sol";

import {ISafe} from "../../src/Safe/interfaces/ISafe.sol";
import {IMinimalSafeModuleManager} from "../../src/Safe/interfaces/IMinimalSafeModuleManager.sol";
import {ArrHelper} from "../helpers/ArrHelper.sol";
import {IDKIMRegistry} from "../../src/interfaces/IDKIMRegistry.sol";
import {DKIMRegistry} from "../../src/utils/DKIMRegistry.sol";

contract Setup is Test {
    //////////////////////
    //    Constants     //
    //////////////////////

    // Safe in mainnet
    address internal constant SAFE_SINGLETON = 0x41675C099F32341bf84BFc5382aF534df5C7461a;
    SafeProxyFactory internal constant SAFE_PROXY_FACTORY = SafeProxyFactory(0x4e1DCf7AD4e460CfD30791CCC4F9c8a4f820ec67);

    // Helpers for tests
    uint256 internal constant DEFAULT_ROOT =
        3693852034816220969980398025931646744713742489852125909138985185751997118833; // From default accounts

    uint64 internal constant DEFAULT_THRESHOLD = 1;
    string internal constant DEFAULT_RELAYER = "ad@oxor.io";
    string internal constant DEFAULT_DOMAIN = "icloud.com";
    bytes32 internal constant DEFAULT_PUBKEY_HASH = 0x17655f0139cacecc80f4143fd28e7107ce6038374ea9d5cfcf5d3fb5ce0086e6;
    address internal constant DEFAULT_TO = 0xdAC17F958D2ee523a2206206994597C13D831ec7; // USDT on mainnet
    bytes internal constant DEFAULT_CALLDATA = abi.encodeWithSignature("totalSupply()");
    uint256 internal constant DEFAULT_DEADLINE = 4884818384; // Tue Oct 17 2124 05:59:44
    uint256 internal constant DEFAULT_SALT = uint256(keccak256(abi.encode(777)));

    //////////////////////
    // State Variables  //
    //////////////////////

    // Safe
    ISafe internal safe;

    // DKIM registry
    DKIMRegistry internal dkimRegistry;

    // SAM
    SAMM internal sam;
    SAMM internal samSingleton;
    SafeProxyFactory internal samProxyFactory;

    // Guard
    ModuleGuard internal guard;
    ModuleGuard internal guardSingleton;
    SafeProxyFactory internal guardProxyFactory;

    //////////////////////
    //    Modifiers     //
    //////////////////////

    modifier fork(string memory env_var) {
        string memory RPC_URL = vm.envString(env_var);
        vm.createSelectFork(RPC_URL);
        _;
    }

    modifier enableModuleForSafe(ISafe safeContract, SAMM module) {
        enableModule(address(safeContract), address(module));
        _;
    }

    //////////////////////
    //  Help functions  //
    //////////////////////

    function setUp() public virtual fork("MAINNET_RPC") {
        safe = createMinimalSafeWallet(ArrHelper._arr(address(this)), DEFAULT_THRESHOLD, DEFAULT_SALT);

        dkimRegistry = new DKIMRegistry(address(this));
        dkimRegistry.setDKIMPublicKeyHash(DEFAULT_DOMAIN, DEFAULT_PUBKEY_HASH);

        // Create SAM module
        samSingleton = new SAMM();
        samProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataSAM = abi.encodeCall(
            SAMM.setup,
            (
                address(safe),
                DEFAULT_ROOT,
                DEFAULT_THRESHOLD,
                DEFAULT_RELAYER,
                address(dkimRegistry),
                new ISAMM.TxAllowance[](0)
            )
        );

        sam = createSAM(initializeDataSAM, DEFAULT_SALT);

        // add TxAllowances
        bytes memory data = DEFAULT_CALLDATA;
        bytes4 selector;
        assembly {
            selector := mload(add(data, 0x20))
        }
        vm.prank(address(safe));
        sam.setTxAllowed(DEFAULT_TO, selector, true);

        // Create Guard module
        guardSingleton = new ModuleGuard();
        guardProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataGuard = abi.encodeCall(ModuleGuard.setup, (address(safe)));
        guard = createGuard(initializeDataGuard, DEFAULT_SALT);
    }

    function createSAM(bytes memory initData, uint256 salt) internal returns (SAMM newSAM) {
        return SAMM(address(samProxyFactory.createChainSpecificProxyWithNonce(address(samSingleton), initData, salt)));
    }

    function createGuard(bytes memory initData, uint256 salt) internal returns (ModuleGuard newGuard) {
        return ModuleGuard(
            address(guardProxyFactory.createChainSpecificProxyWithNonce(address(guardSingleton), initData, salt))
        );
    }

    // Create Safe wallet with minimal settings
    function createMinimalSafeWallet(address[] memory owners, uint64 threshold, uint256 salt)
        internal
        returns (ISafe newSafeWallet)
    {
        address optionalDelegateCallTo = address(0);
        bytes memory optionalDelegateCallData = "";

        address fallbackHandler = address(0);
        address paymentToken = address(0);
        uint256 payment = 0;
        address payable paymentReceiver = payable(address(0));

        bytes memory initializeDataSafe = abi.encodeCall(
            ISafe.setup,
            (
                owners,
                threshold,
                optionalDelegateCallTo,
                optionalDelegateCallData,
                fallbackHandler,
                paymentToken,
                payment,
                paymentReceiver
            )
        );

        return ISafe(
            address(SAFE_PROXY_FACTORY.createChainSpecificProxyWithNonce(SAFE_SINGLETON, initializeDataSafe, salt))
        );
    }

    error TestRevert_moduleNotEnabled();

    function enableModule(address safeContract, address module) internal {
        bytes memory cd = abi.encodeCall(IMinimalSafeModuleManager.enableModule, (module));
        sendTxToSafe(safeContract, address(this), safeContract, 0, cd, IMinimalSafeModuleManager.Operation.Call, 1e5);

        if (!ISafe(safeContract).isModuleEnabled(module)) {
            revert TestRevert_moduleNotEnabled();
        }
    }

    function sendTxToSafe(
        address safeContract,
        address sender,
        address to,
        uint256 value,
        bytes memory data,
        IMinimalSafeModuleManager.Operation operation,
        uint256 gasForExec
    ) internal returns (bool success) {
        bytes memory sig = encodeSenderSignature(sender);

        vm.prank(sender);
        return ISafe(safeContract).execTransaction{value: value}(
            to, value, data, operation, gasForExec, block.basefee, tx.gasprice, address(0), payable(address(this)), sig
        );
    }

    function encodeSenderSignature(address signer) internal pure returns (bytes memory) {
        bytes memory sig = new bytes(96);

        assembly {
            mstore(add(sig, 0x20), signer) // encode address of approver into r
            mstore(add(sig, 0x60), shl(248, 1)) // v, indicate that it is a approved hash
        }

        return sig;
    }

    // Since after each contract change, its bytecode changes, and thus previous proofs become invalid.
    // In order not to change the proofs in each test, we will make a default proof.
    function defaultCorrectProof() internal pure returns (ISAMM.Proof memory proof) {
        // Proof:
        // Tree constructed from all Anvil addresses
        // From: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (0 Anvil address)
        // Calldata: 0xe75235b8 (getThreshold())
        // Call type: Call
        // Nonce: 0
        // ChainId: 1 (ETH)
        return ISAMM.Proof({
            proof: bytes(
                hex"000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000ac0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000c9b957f94c58eec64b688ccdfed79aac6a000000000000000000000000000000000020c98cd39cb55e2ad6a289e7e175bc000000000000000000000000000000bb5fb5d23596fd5abcc9ad00a4275c20d80000000000000000000000000000000000074620fcb1575a1adac6dc77da2d7b000000000000000000000000000000b4722beddb96011800a36cd791781cf09c000000000000000000000000000000000010ccac2de1c42190e76e1a4fb22fc700000000000000000000000000000007e5e51827c6b64852cc7b7a2b1d44247300000000000000000000000000000000001199e032c757e560db0611a505ceaa0000000000000000000000000000007dbf05935fd6bdc4f2bfa30e4749cac88e0000000000000000000000000000000000076a3fabd5e1deb971d55d3e023c51000000000000000000000000000000c1b42d23e34ba575e0c47f8f70c7b9802e0000000000000000000000000000000000208bbac8f671b28b4a3a695e3f849d0000000000000000000000000000005b9b3611c1636571422f1ce8e063f33a9e00000000000000000000000000000000001fceada00528fb209840097d2cdd18000000000000000000000000000000a44c6b393ecb26d8fed8d6109ebf6f540000000000000000000000000000000000001f44addc9f2bbf5b0fd7bf77846dd20000000000000000000000000000007307a59c59f613f21d34372a3261e8ca16000000000000000000000000000000000003779650c8431646434c5b23d50f69000000000000000000000000000000c1783b1f794400a68491de7d2c3bfe29750000000000000000000000000000000000141aed242bfbf36c8b0ae768a083a2000000000000000000000000000000ee417b44dbbd83ba7b188484dce1e72df5000000000000000000000000000000000003c5e9f35c1a3bb7ca0af2ab78791f000000000000000000000000000000b5a5c1156a15812f40e5e81a098b0812d5000000000000000000000000000000000015c2cf1ebb3aaa0721ebcfb37c053d000000000000000000000000000000d45904d4066812f925ef510fd46f3fc32c00000000000000000000000000000000001277900b95eb2363ae46fb86311276000000000000000000000000000000a3e4c57168b12f431519899a4eee15cf8d00000000000000000000000000000000001c604967c84d9874a0a385ab7a8a0b0000000000000000000000000000007ecc723c819d9f7f4978ff5d102d48959c000000000000000000000000000000000024ce49a962e7bb429817dcecf42dad00000000000000000000000000000000d41c251ec1da7c109d65cd1ee600fd6f00000000000000000000000000000000000121b90b29049161b553e9c9f5634403b311ef89217d7270142a96bcfbc65b8888165801dfdfa5a4d70bd449b07f902cb13c83581022b7483c1b1fc48592019fabd1f077d990eb9f0ae9bfa64f8071242fddd2ff921c16dea92cf9660e3c7d7d395b56d2eff66237bceabf601983eb302447f36320257ba3f9a2df194f6fdfc10aea2a99bc48bb8f07efbeba9364e614663db70529c1e84f0ade9ef94484c3444df15a5d67887283c5e6d90e8328e22a9ec38f8a8a09a028dc681d6dc70268152ed0b152f1851de49687174588fdca072d459947151b8f10b39092a5da7f009de93ae26c0d1e4345ed1fbc45552baa265ff5d455dd56ab199797ae8e4ee2be851ea046b9937e1e2dbe4ce27a7afa6526c6a26e44a5a12d7faad98b23963cf29503405feb38ddf87d7acd5348b68efe18f11c437961f14a312e3569b9f3f177a5e1e080b763f75bf850966b8277f94e2c4c9a11649b9d52784e8861cc9fd214eb5dc975b4778b5873c24d68dae661c4093da18f45725e96c15815dcaa5e724b19e339be718930a9d69381375462a5d90177bc49581bc41b6da4cb3b0a1ce61997a2041b3459feca46e5109ab1636e15258ae5d2fce1e6a2e5c6dd4ae05a3ad6c9392552d40fdd7e708aea5a5ad24ccc2b439de045093f30d68c13ba21eebf55e6f26f68213f812717e6c04eff37d4912c56e091dc400fdba94f95b81de13ee29177fe8ca84a4c13ef8168dc45e26c821a4d62c4de96cce44a7507007e7aa23c88c3339da3facbaf91217e2a8712e0d905f1f4b7deb452658b82cfee6be5e2f7e1e89b3673baa119983df0fe0d3cbf362cbc56444272f30673408dac7eae5c8aaceb1ec8e3422de602735f724bd712631c8c7d069f658df47b6cbac848e918c0f50cf76a22b061633afa75a4f86a73f812fe3cb9f2bfe4a658c3522bff949019b9280a1f48f0f7ee48fab48180fb6c5304b46161da4c3f3a88e75529e20683f33f13a55f471fa225ffaa5a241ba2366917c924d07d6b673b9b4a27a572d6b78d6aba224dce8d52ad37f29635caefd511031c6319ba9d02770683a5a3458abd10677f6488db8adae7173b6fd162aa473512cd774ef0a6119651f6f718ec9d2a0eac031320acfa1e78f62872a4d7ef88c8138925007172534e60db7bd251bd404071535261aad912ca0d01e304e11b71002800257e4fc7437a57f96a3c12853fb0425640065fc1f54be489a3548d0287b51cfe0a5a694bb30b244c3c93de79b75ba9ad2814b922f737f83c4c3aa34b89b117efaa6cd7eb10e815ee6e0adb4c59a38353f07d0473c1641f4ea1802de6475b1f9460d622bfcc21c69793ee87b660a9447e1bb4e254b04655dbefeaa1fb9e1c2f65c32c59ef2e7d300b16aa2147bf953846c7e2c9c076e3ec379dfccf4ad29c248cdec496de37f25b5486d2fc7818e4b04f48eda3105c3c9e94a4cbbdf5d55f1344498ccd611d65b9c10099f9b136bf23538d2dadd83451954649e858016e491ddf4a512c84be417a171811d9463c87ef9a49c35ab39f38bd7f9125bb936f5608ef49652b347780c857745fb9018408e9352ab3bb7de556e3f234aef8d35f790ea5f413eb941d4a26bca651f6322c0f185058fae04d55e0db4db195c23634ee290fe86851e2c13fa026d662a12f788833aaa3cf5381630ce6ff68ab61ce207000f417d3636312057252f7e8a1f176354eb739946e9987bb5e5903ff03fe1c8127ca2c65aa4ccc47817ac00b542608fedd048a9bf8abb902c2efcf3976eca42c2cc5779c94d121c656a901bdd1a5f5d6f1b116d108ac078c527f6804a2178c6f2b397949c8e37bcf3e00bbb68bad62061c5ce1f19ede2702ac938f8f9394579a2b72d85811325d7cfd11fdc7726f1a3cf312ef7089175b0e49966be2cde46fe000ef2039e8c8f14d9850cc018e22e1f4832da4ffd26896f620f75100e79e102a0970d632c7e817c258f96ea8559e07bf68729626025ed1b077e28507e0cd6398069ed7109fe9d6922e6cddf040838fd0bfb4dc4d58fa73bbe609801b430d99d1227ad26f938af661eaf6799015b8e7751c0a1f1f91497683cb0ade2944af63ae2f7f5af7fd1703491703507437cc743ab325bc10f65f38b30fdafab4953d03d40dd86210a06627d83aed0baf94635720c6d9d4c6ddef53f7636ec0f9c7f9e7180171f27e3f50af27d5fce36e9f9c5f77a17cda244cc20c41dd091c21dd16c2a31fac7fa8d73ced2666a19b0780b3288b3ea16dd6e46d8e532e132615d5022adc25e23ccd4bc7dff4bce8090fc9b3ff248ee5741ac681b29ed1c4350531172aad0b4d0482b84f0fae6090fc03a02bd703437c4ab1a0344cb8df29c4bdb58d281b01c3315f8b093985fc890f14255b3c54dbcb313a4f542c3352253147cbd225ea1827f3aef6611afbe1d7299f9f24a852d60f6fafd07eca8802e2824f64cf1398244e91b20f581f9529703c14a4c5b72c803db630fec260366136b84f0782535b194c37b8d2c8a0ed10cf5539802b6a88700cb9181ef2decc0aceee0e5ba0eacd0948ff46b356645cc0870a04412e8685f2b36383848b3305ffccfb408ba5b7f314dcd94c8bbcb0b0b278aa8a9e03a03a8a538f9e0e8d6f8dbe8d12b4f4f1dc782850ff89bb33e15fec0c8a81793999ddf9072d9cf35cc52a75f6af96d69600661079405f35e5e19937e33986557932055b548cc6af508721b08444e5bcad029822cf22f2e0a0b0fafa1bc461797b0014b0f8797ca7f931db881a13d034e631ce0e00bf8eb165c6f25e32c3e00a27b554e478cf070c73f3737fad0eb194bd1fa729abc7c9573307cd7f139fe4cb0e5fd36240d2f356a374f2c916eb0caab9a1291af55cada2a45f02f68cb063bb9eb90c8ff8bc8a49d8be82f381fa2c90dca6ff079f3a1c5a0d0fbe021fb9f9f93933c1df3961de3ecf2893f57e8a529954e06d15d0a55d0855f5715d3a2a5e63d17c0623bcc72ccff149e5a6020bf6837088350df9626d33e0fe29516a383e99e6035228cb4a0147471c5484d96ca62996584f2da85c0cf43499e45aba9feab4fcc9cde84979c757854c9db6f870e5b8c7e56c0070f5840a9e0ce447ff7502d907a1f35b8a68c6cbc3c0611327ea942862750d06060e7dc5839aced53e0326d1270ab6d1dad6266dcf6d485ec2187f5088f1450fee1c25db88f8552d8b3e9687da47edbc3e7034ef324e4b2232c41af06f24b2161764cddb8ca7740d69fd77c18cbf70c33f55d4c7d550fd631b64a9b65284670621a8fa819582072f27347b362cbfe3c20207844cb0200da1ddcc857591dada1a0c2e2a516f8d1501419616be826bc9ac2b57733012c45f5fdd00df77ce893b27cf3d84386278935a0af4ebc29d5c10f13893d6011fe39b9f96ad585f5456331f0985aa1cfd3b340d2e9975b6b2520b15c0cde8510a0c6dd9955ac0559f20b5054df3ebef479fd68b74b25004c49c4b49f7992d3cf68042f88b4a6f84c6b1912419d074ed347cc4afb95e1cfc7661b4863a2e92721682e36396f19bf68a2c28240c5b34608d9ed823fbba6552c84b8a4f113d14f60ee4df3b1684f465ddd317110bd463416bdd136ea2463741267492f70b61d676e33723073e3661d62ddc6430470d5ae292f56cb7b2471251c0845fa2574627305beb49df11c4160c1f4eec17199a0b949ffde3d441a0bbc221d3f41ee3d29f383e61036621c7b90a0e434e27ef5b46b85d99a3b5346b32a68e5e73c804285fcbb3e12a7036fa4c5aef220e2b072b924717a3ad8de4b009c71d3fc8e7748ffbd822d22a48a08a9288f3156a184691938fc57b050793b21adbb1adbd87e4ea55e83e121dcc23051be3a4859021ae4f64b70633bb49cf71b6692b803d0b5f56050109509dea131a2344f56c8b16d127776766bc300168cc7e1d6c71fe2e8c589f8cfc28d0bd426c3a2edd0d3629ded6365f7e85a7309e3f2deaec72650a3827df6c49cb28d426980bd6ff74d91836251c33859459c838425abbd68cb9b11d3f370d3dda0b1440d0fe9eec224d0d462eab1ec2304ac5e8bef12587effc24fc49dab88bf7b0e192253349c1960300381a7e56df229728d229c1825e8f5b29dfd474599b75b83f53b3a290947b660864d83258abccad089c13db242f76254a6197e8d45059df18bedff2634cc64924d098d572f5779083ccd4a92477e2a2988e4b21040ba75f81823358191d179a0b3bff183b15a687a603fdb72c3e0fdf610a9c494528dd5602a819b138a9eb9924a45104416c6872464060ad369a05c933e9271e0a15298bad2d9828f58845a21cdabc6a0dd20bd6c122d086452d1f3336b1c6191f211fa8d178363989eb8dfb1eddfffc05a60d098493c8e156c581feeff6e90701165d36859b189edd36a48511f143fc4c3fe19e8793107c3f1bd1d615ce2ad3e37c8f010229da439cbcd4d801b01b0451825f7785fcf0f1ee2bcdf2ee9075f8d2eada866acdfe7abb9294ad1c145fd5b495b50e8e8f55a2330fe209583813ed76d831cf77f3b1a04144785210d1038162a9d25a1d1394444e7d834d9716f16c21ba45fd407c03de343c52f7269eaf8a101e306f1944c6ca1b1e85615ce14799ee179be987231760956f7613236063decd76cdbca0c5609d6006a2cd8d8522aa37b2a157079ab8cc362943852328fc72f83652dedcc849fd98da5930c53fc2834dc2b8f77b193b49af29d16e18dd52dde4ee71fb3e88ff5dfe642953bd1765e18e0f61105ea1ea05bf32ba7c1f6214eaafb84806de8e7a3cbcaeb902eef1ef767162322d653e6c32e73019ec1e10cad7c7190b64fe84acc185b0654c2671906757f97f7a9dac45f4682461d41d4b51733dea2cbb186add3bd39d0d6d3115db1fb94aa79848836dcc90d7fa9f0a9b1f67c66ae60f57a1228fe91f1ac040aa4e0f246e13678e4e39b25d2794b629163a7bb77ed0b709079bee1a2fdbc3ae24f67bcf8a6abd29861d02e21becff1d74eb4a4aaba225759bfd3725b5fecc4d268cd82cf5a5e104e867b8b45e5ccb0dbc70c75389cd6d2a49715006b89d263fdab4e9cbe0900824b1a67ae1cb25b60084ba4296ed01db04f77f3e565fc13b37933b813c0ade97524e441a557ca3d41761b22d801228b9072f033921707e44b3654b7e6e0c0067270b0126ab86f5dc0e0d66932925f3af46c01a98e06b593a1c9c9d19f8731e84b20a3a5416d226d3010c9dc7775769618d03db66bcf6f9eea43ffd824ea1bd6bc16de1cf2d0078080370902cca05fe09a88f6acfa98b7fadfa052ae3162edd202f71568c2bf778ce0463365dfbf30f672b5d121fc2494fba75318cca269a80ec11741cc75659204011b95db64630c7243759ceee4bb73c892ee19f1cef04da4a924f645d9b6bcf341635cbae4e1d6a4f83692f2d428a7377d99393caae55e1bf8585cfcfc4ecc801122dcfd2d9e22688136469021483815ea11e2d001bcb78a32dd680d843537033057fdf51a5f1f18dced8a4a2a2b71edd368a419dade3094fe6b238a2aac50fe02e794901e81941f76ad941304eeb0f6b5d3e815e2fbdc999156ee69b16f693d021a66215ee45a1a956c339af70d3738511dec6693c29c2f2846f43f174e941d5251cd60ce9c0a73ad67124c1e7fbfeb6bf0d8a923151a428103d41b2e60a24f317b4fd9d062ae83c8b4355a932a01b9dc7b64e123e659d2d8e4cd19b649c0bc21dfaafc8cdacb73f80b4fc16c7ed42af395a7cd98e94118b8e2ddd2f452add010ade66c3c6775af764855ec1530004a1ec634a6331242382f4a24270318a9422034892ca2b5fe66ef4206128bf1503ff031f200e60676c36cbd2a822ecef03380eea8d63b0a2cf2213e6a1898c67cf5ff978e073c77b41176ae75e7535888b310f825fc9b325460f1fc36cb0eef36d7f9726ef06fba28f3336fd4016c6e19189201d1f19ea33787cb94fb2aa222010c73760d92d7630cebd20a71d27316b48bf238a457d111b6bf7e7ef66cee12b7f343b818f2e42da0ad9612168fb339ca12626988a0fa71781d64aee0364b96866d32f8463806a6b414c759bc3857a455c7c065fd651033f67f7243cc71f3eaac9003bf069a08c47283ee64c0e1b40a35a610981bfb5d4d601520598b898b0c8bf2f95080755067a7b3a3b7d23529bec13d120fe9e9ab60a56dc7fbc8e9ac056e92a88ef2ac767dc9edfd4ca493a9360d3c32e9072a67ee9843f95ab929184dac4b3297afd5ace6b1b3b7a86e3a85754b8542213655d2bd45c3e7fca4fdfba2c4f95de5334807d26ab801181de4816ec934e11e5b4d6bcf441d2ad8dd1b43c10c276cf413d9795aa5702df80a5fc12eed2b80517c2a9754905b196847626eef4168aa08d0baf57be4bcf8cbaee15fb72f27829763c7de6250a18290eb9a30ab63e753576091460991670b20b31d9cb38325e0819a44fc715a6b4d7c4c85724447e00345b1f6e89df5ef64a8f42ae443ea04820b7bcbfa7d9b1179794da1fabb885ad6001df3cd65548fb30763fce0ed5261c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000183ab34fe72108d2a6ee9e85fcb3564f39690b716cc55480c7c0909e1974a92d111498f47cc6c00858191c75326527dddeb14d09f9566c3e7207cebf51944f491448cfdd1841420f9461d005ab426248153c144f9a8647073944a1b408b878690f1e8ba7a6df8959ec1cab606b2840e52ee24340302c3c7e011705cdf965b05827c133ec816b324745a262e9abd2a14b6734170182d8912cd959093725c22ce603b3d04202712d641eb04f6eefa0255d2aa3bc03a15918fa17670ce046363b2b14d4f3f46e143934ea955a92f0b1ac3eeed020d7974a734a54ee50635ec0651625057654ab9941145b00a81c2ecfc3aae97342005f895f23f6d00f8398cc10a31e69b6a13df93cb5cb8f51593f0f0d54178c8335bb3ef79adadec1de12fd6a7e232ef6d6a0ed066b74bc8a9cc451e7f78c2a66abbe2650973c54c2f0927ad58220b74e533ec600ac7029dfb06f83fa1b51e27431d44d356cb24a8fefeb66cec30e4b9ba0dcc419a06e78401ca786e32ab3356438f6c3740cb650a480b80f45992925771fe1353c822a41e568c60aea5f04c627e1606a7e2a0a3fb3e33a72a670210407fab96edc5328ee803bc51f364b0efd901e8caeb37efc55fdeed1e53e112397f6eba49bba40613cc601fb6002feffb535660fe1578d50def81d51252ddf09be072516a9e60e087ab85dc48a02a1997b312a3d7ffc2831eef79e3baa98b6069957b4e3012bb26ce1664a16922f84e64af1b1a5357da7b7f0f5fccea901f7135737415a3111d53d67fab50a33fc3f36af31911c29369e7d153be011c04a9527c752deaa0fd4aeb0485e847cf0fd6f6b8b8e037876177cc0cc2a705f9951c42e9174dd29eae5a6d0ba968b4a5f24417cde19e64f7ffdc5d6cf9dfd7eb4bfe513ba9a4b015924c6ccd9831bf8d291f352c26d9ad900069bd8dad15e120d06a20a22f9ca9606e60647e0db96274b192524eae401f1c0a7040066132d6d949538057d65eb1be9b19886cf172bf0ee21904e7e47816d925acf9a1a39952e979c410f829a4b5583a48b334fa75ef3c7e8212c5ee085ef071d8c6e0d931d2c326a6d1d5e0fe77b6c7216da0631d37ab1aaeb11c55df506468e5dd29acc8476fbd29f1643996f6d0a3c0cdf36f8658d660467966852e8d7cbc64105e4f01806db6c140a9ea1f216d222be39a73ea3f8e66ad9df67442c5e49be9daf832e511fbecedc04c7d4bed2334cbce80f6cf473c0b589b2cfdebb621d525c16c64cf0be99ccba17bed6f3f1484a498f53a65d7501cf22b3b858e48e06cbd63c2026d3e27dd58d2654de8d3a6ced69ea1c8932e5bd39053e16a032f0e0578de55a678723022cd10c79c497102698211afc60aa5ac18fc30bfcbcd4ae03783caee4670db837881a11e55a566ee1d72f8d5980f1e0db07358afb36207b78b5c3bf1b5abfb0108f7f043c17f46a7ddb9a758713bfd616e4df73dedd9e7b9d5d42cad5311695728b7124a27c4861fa8c532e5ff20d7193e2b08ebb3aea5c586a024465a73f2f2e55ae21e006ca0ab56430b664514a4dcf8c00448ea141298b5717337c561df7b5e1430ee2df10ae989eb86ba75e8a65e60d3c8aa0db5b0611f9efe27a3bcd8ddd9f8d20cc71693018e2558bb27568fc5a4a8b3e53a27036052695ae52b4f3002f9e6d022aa08eb1b40acecd5a104aa564ebe87116fda1edda52dd8ca47c6a7b8f097d24e90357f57281f23353f0827b90b66b5fed939ed8f70df8a3bf087dbc21f6a011705bb2148d14b8ae7ce0653f753ddd1c21727523ccbe7da6293ccd025387bd0d4b192b23ca726fdfe8a8c74d16585859c993c25b4731ebcf9c3b503eccf8180a7b4b62f14906c44ca7e8a99eeb7785a95720a60bd1adb6b359bec1bd170dcf2020c602d420c91ddd3e8114d0c3179e1f570744d9ecd8d613e883740899c0c311594a7e2cd8c5d13c33721052b15660a50a4ea375f93f97641cc58959797b13"
            ),
            commit: 0x01e756223c5baeccc9076912dcb9c1dc0d6f1c24187f678682017e93920784e8,
            domain: DEFAULT_DOMAIN,
            pubkeyHash: DEFAULT_PUBKEY_HASH,
            is2048sig: true
        });
    }
}
