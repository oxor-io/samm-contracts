// SPDX-License-Identifier: GPL-3
pragma solidity 0.8.23;

import {Test} from "forge-std/Test.sol";
import {SAMM, ISAMM} from "../../src/SAMM.sol";
import {ModuleGuard} from "../../src/ModuleGuard.sol";
import {SafeProxyFactory} from "../../src/Safe/proxy/SafeProxyFactory.sol";

import {ISafe} from "../../src/Safe/interfaces/ISafe.sol";
import {IMinimalSafeModuleManager} from "../../src/Safe/interfaces/IMinimalSafeModuleManager.sol";
import {ArrHelper} from "../helpers/ArrHelper.sol";
import {IDKIMRegistry} from "../../src/interfaces/IDKIMRegistry.sol";
import {DKIMRegistry} from "../../src/utils/DKIMRegistry.sol";


contract Setup is Test {
    //////////////////////
    //    Constants     //
    //////////////////////

    // Safe in mainnet
    address internal constant SAFE_SINGLETON = 0x41675C099F32341bf84BFc5382aF534df5C7461a;
    SafeProxyFactory internal constant SAFE_PROXY_FACTORY = SafeProxyFactory(0x4e1DCf7AD4e460CfD30791CCC4F9c8a4f820ec67);

    // Helpers for tests
    uint256 internal constant DEFAULT_ROOT =
        13478250241025044241834632636828135155416924205892387731890373634766567630611; // From 10 default anvil accounts

    uint64 internal constant DEFAULT_THRESHOLD = 1;
    string internal constant DEFAULT_RELAYER = "ad@oxor.io";
    string internal constant DEFAULT_DOMAIN = "icloud.com";
    bytes32 internal constant DEFAULT_PUBKEY_HASH = 0x17655f0139cacecc80f4143fd28e7107ce6038374ea9d5cfcf5d3fb5ce0086e6;
    bytes internal constant DEFAULT_CALLDATA = abi.encodeWithSignature("getThreshold()");
    uint256 internal constant DEFAULT_DEADLINE = 4884818384; // Tue Oct 17 2124 05:59:44
    uint256 internal constant DEFAULT_SALT = uint256(keccak256(abi.encode(777)));
    bytes32 internal constant DEFAULT_TX_HASH = 0x09b086d54be973c0cae8f289b9a308969c3a0d336ba3000651cffcde84ce5fb3;

    //////////////////////
    // State Variables  //
    //////////////////////

    // Safe
    ISafe internal safe;

    // DKIM registry
    DKIMRegistry internal dkimRegistry;

    // SAM
    SAMM internal sam;
    SAMM internal samSingleton;
    SafeProxyFactory internal samProxyFactory;

    // Guard
    ModuleGuard internal guard;
    ModuleGuard internal guardSingleton;
    SafeProxyFactory internal guardProxyFactory;

    //////////////////////
    //    Modifiers     //
    //////////////////////

    modifier fork(string memory env_var) {
        string memory RPC_URL = vm.envString(env_var);
        vm.createSelectFork(RPC_URL);
        _;
    }

    modifier enableModuleForSafe(ISafe safeContract, SAMM module) {
        enableModule(address(safeContract), address(module));
        _;
    }

    //////////////////////
    //  Help functions  //
    //////////////////////

    function setUp() public virtual fork("MAINNET_RPC") {
        safe = createMinimalSafeWallet(ArrHelper._arr(address(this)), DEFAULT_THRESHOLD, DEFAULT_SALT);

        dkimRegistry = new DKIMRegistry(address(this));
        dkimRegistry.setDKIMPublicKeyHash(DEFAULT_DOMAIN, DEFAULT_PUBKEY_HASH);

        // Create SAM module
        samSingleton = new SAMM();
        samProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataSAM =
            abi.encodeCall(SAMM.setup, (address(safe), DEFAULT_ROOT, DEFAULT_THRESHOLD, DEFAULT_RELAYER, address(dkimRegistry)));

        sam = createSAM(initializeDataSAM, DEFAULT_SALT);

        // Create Guard module
        guardSingleton = new ModuleGuard();
        guardProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataGuard = abi.encodeCall(ModuleGuard.setup, (address(safe)));
        guard = createGuard(initializeDataGuard, DEFAULT_SALT);
    }

    function createSAM(bytes memory initData, uint256 salt) internal returns (SAMM newSAM) {
        return SAMM(
            address(samProxyFactory.createChainSpecificProxyWithNonce(address(samSingleton), initData, salt))
        );
    }

    function createGuard(bytes memory initData, uint256 salt) internal returns (ModuleGuard newGuard) {
        return ModuleGuard(
            address(guardProxyFactory.createChainSpecificProxyWithNonce(address(guardSingleton), initData, salt))
        );
    }

    // Create Safe wallet with minimal settings
    function createMinimalSafeWallet(address[] memory owners, uint64 threshold, uint256 salt)
        internal
        returns (ISafe newSafeWallet)
    {
        address optionalDelegateCallTo = address(0);
        bytes memory optionalDelegateCallData = "";

        address fallbackHandler = address(0);
        address paymentToken = address(0);
        uint256 payment = 0;
        address payable paymentReceiver = payable(address(0));

        bytes memory initializeDataSafe = abi.encodeCall(
            ISafe.setup,
            (
                owners,
                threshold,
                optionalDelegateCallTo,
                optionalDelegateCallData,
                fallbackHandler,
                paymentToken,
                payment,
                paymentReceiver
            )
        );

        return ISafe(
            address(SAFE_PROXY_FACTORY.createChainSpecificProxyWithNonce(SAFE_SINGLETON, initializeDataSafe, salt))
        );
    }

    error TestRevert_moduleNotEnabled();

    function enableModule(address safeContract, address module) internal {
        bytes memory cd = abi.encodeCall(IMinimalSafeModuleManager.enableModule, (module));
        sendTxToSafe(safeContract, address(this), safeContract, 0, cd, IMinimalSafeModuleManager.Operation.Call, 1e5);

        if (!ISafe(safeContract).isModuleEnabled(module)) {
            revert TestRevert_moduleNotEnabled();
        }
    }

    function sendTxToSafe(
        address safeContract,
        address sender,
        address to,
        uint256 value,
        bytes memory data,
        IMinimalSafeModuleManager.Operation operation,
        uint256 gasForExec
    ) internal returns (bool success) {
        bytes memory sig = encodeSenderSignature(sender);

        vm.prank(sender);
        return ISafe(safeContract).execTransaction{value: value}(
            to, value, data, operation, gasForExec, block.basefee, tx.gasprice, address(0), payable(address(this)), sig
        );
    }

    function encodeSenderSignature(address signer) internal pure returns (bytes memory) {
        bytes memory sig = new bytes(96);

        assembly {
            mstore(add(sig, 0x20), signer) // encode address of approver into r
            mstore(add(sig, 0x60), shl(248, 1)) // v, indicate that it is a approved hash
        }

        return sig;
    }

    // Since after each contract change, its bytecode changes, and thus previous proofs become invalid.
    // In order not to change the proofs in each test, we will make a default proof.
    function defaultCorrectProof() internal pure returns (ISAMM.Proof memory proof) {
        // Proof:
        // Tree constructed from all Anvil addresses
        // From: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (0 Anvil address)
        // Calldata: 0xe75235b8 (getThreshold())
        // Call type: Call
        // Nonce: 0
        // ChainId: 1 (ETH)
        return ISAMM.Proof({
            proof: bytes(hex"0000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000004f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000662800a0e2ad2fe31dd79833740beea132000000000000000000000000000000000013339d1cb2685aa62c06713df5c48a0000000000000000000000000000000fc4f85e35380bd30d7e60cf96021a465000000000000000000000000000000000002ff1d74743eedd310f839ceb5845800000000000000000000000000000005320ecdfba9187d09461b39e9cebdac72a00000000000000000000000000000000000496c45c3dac29642a3d5dbf67e8cf00000000000000000000000000000047080baa186b8d16c8458b2f28b363db01000000000000000000000000000000000018189d3af31ed3f89137b0e0e4a8fe0000000000000000000000000000006c0d0c3c6f053433a1f836773060a0766b000000000000000000000000000000000026711f2d0d0fe8999fe373b2447bcd00000000000000000000000000000099fc7bfcef681f707238f2d3602296a37e0000000000000000000000000000000000194be0af4844dc20d53d0771027b0d000000000000000000000000000000fee94974ed0926a6bee058f041fd6dd349000000000000000000000000000000000014268b39533e31373e2fc4dec9a5b10000000000000000000000000000007c9ae9a2f0b1fa0846077db33884108f0700000000000000000000000000000000003039a8977a9c418ec18ae8a21c8337000000000000000000000000000000f73f7756116bfc25f049866060344968520000000000000000000000000000000000060b877715811294285dba5b95d2bb000000000000000000000000000000c5c00c21981096cfafa203467d1c9c61ff000000000000000000000000000000000028dba32e01f4d0df6800cb3dfcd243000000000000000000000000000000c1fe351073d8a7324a5018a480065fc08200000000000000000000000000000000001d8b8ceaf42b787706c4235ef561ab00000000000000000000000000000057998335abbdcfeb98d711dc1150635cae0000000000000000000000000000000000090e17e4d7b74a59c9089e470297de0000000000000000000000000000005779e8ea4c094ba01e82b3d3f24730bbe700000000000000000000000000000000000ed4295921e337f68e9811424ef84d000000000000000000000000000000f41167272be3aab2493998df57597ef79b00000000000000000000000000000000001304a3966b46c784688ba9939aa2d70000000000000000000000000000002853f414a4780bb2504222b0c8052df12800000000000000000000000000000000002dbecb8aee4afc5e45b05b5caa28e6000000000000000000000000000000a7da248e3e937d7a5a1fdb1674e13ea009000000000000000000000000000000000020646366a79a25962383d9189d68ba1f9720799d50f6d376cb852be521e484ced79adf623d790b0ceeb50d5589e90410cd2df943e0a9564184c08a9c5f73d8595c4d69177bf78636f340869a7616fd16668051d998f40eb77701e70b007a5bb272d39eb2929497fffdc20fb306b1a02e2523edd40b146e3ac7cf403dbef9eecff30f8bc4cebe6a82abd38eb341ed75114fd4a7a9b63e73c749ad7374afb7cf0cbc54e6c3d16299735041df7bf4d5570adea1de94fcab0d16c6f1124bb40f9ca1886985d7c65d1f81d39a32e25b3262257b663d41565d893e32d812a5ab6582a899a8f394980fef05e64885babb30f40427ac2c4331e2b31be6e015147dc60afb03c6c280a3ac441096a205fe30051504caff61244a8eff6e6e23e5ad0dec036babad30294d7857c1126e12f39cbf8419325f6747f7ba268a9da862a4da3dd1139bc9eb6edc64ee20b4a1d8970ea459003b559924dfe99116704a3518bf1a96360c79196a7240445ee1d199b527d79c2917dcfd5e94fddd38cd05ace3afac74e012fc6e42450e30446b0f54fd1a7c3f12d892f9438b5a00d27911d95bc8e063a9fe39aa46aae59c25438e1205af04ff21d40408164493088e48631b3464a57f9dd7fc6a2964e82372a78fc91fbb8cb50be8b585b1d963513672c13a508fc58219526621b6eddfca8f3c266fc55e2e1d13c75ce61e6d356681ac6c3b60f0d96b6b90644794efd52401b976c6d3da878a05476ac19ff533afebccb43230c192c836905ca17cbdaa0cf1540674f3f071cb1594f550bb93705cafb19fdb7d2af4dc588348c24c756e29b7c7e35aaeec1d4b23c40d9c9a5c56921d421048b62d3bc336283067369b5922b5800c2547947fc300c16e280b6e1651b295139f6abca1b5ba4cafaca2f9ef221b7f77c15b8b5e651cff1d5fa0598dfb68e5757ebc6705b66553de4a61ff3cd5ff40a4a72971d8eb2af8e97a0712f36d7d716e0a5cb20ee15454da3061f021b7265e001bfa53551c2446cc0f9bb3fd2c752dd3506a095e9c5d915525788e1c9800e563bcb96fe69f09f4f94e1cbef92f2625898a557d7bf609cd6301306248d1790a0e79160ee5b72d8d8db0baa0148ab9e46710ed16c2ac548d5e5977c9619b7e852254419868fa227f4ec3755d76bf1124e82093e5009faca300eb8680c3bb299c1ea0671e2138099ac8df9b0f3c7390d923016235e5be2a6aa125631dff6e3b860c9bd699665a1aef3c7e52dea371ce68a077a4d8653a06bd41e199749fbab31aedeeb40b01171bfc716f9d3eae8d2d114d33c0b3621c80c5c6ac105172e601c4f120dde7d5dc13a97fa144a2035261d81821549e5a643125452592361d5007971369431457240cd158eceb13116d624fc7c162a91ad5afb9c787bd437f35418f1001cd4593121ea5f18a5488dc05d19ddc57f15972639ce392f2d240d30b7abe37b2144640cf1683bfa04d48e392b68b55eb373f6658a3621ec9a77599aefac5c28f72b3093b09e9a3e310957f2f69c41c2b706fa640dd0dd9b82eef1d82ba71d7f81408c1f0262e9afc1326316642ee01afd916e0df62d07d96a370c198fbf8a7d9ac73e4b503f6c4ac8a9dd6cac52fd6ab2d8122b2ec66756754b6342d107278cb685ffd2e2796ba1048df73d5fc0620e82eb0e207818aa1576777a6fa4fe205d2b955a8942f8daa6c1c86cac02d29dbe2f5d78c157faa571f05e8f385455f1e87f6abcb630a45874bb263fa0a9555f14a3d9352827225ccfe1fc16a22a0964c880775a91600cbf77bfbc6a0ba317fa0c35fc787654add8e731d3fadc8d2a38e537131cdb9122da6a76995cb9707305cf90a98320d00240e402db15ef87e49dad414a461cb0e540ef51967683841f6d8e2b4e410b06ca2035c2d231d2b2fcccd24160d43141719348dac83586212c0a53007bfac14a1f616268e8a6dc95c5449fa339794c700b919a0235e1fae34d59cdb40cb4cb6d21afb65f3ecd365cb0ed3d40764487f1711ff9dd6d4c619619329db6497420ca2098e8f2e70521b3ce7635ffa6916702bd7b8261aa53273e20bea6c3f303d5415bb6014395ff6cf65199725b3936b602e3ba37ee0e7352f1a8f37c8ba7208183b6d02493aa08451d6febf1db35fdd1a17c4594fc01b8f7decc0708bd6ee664a7fca6a280129d810d8f05abd017e8cb82105eb502580bf8d4a164244c1668e6ede6bb8c3ff48e16d1bb7845b1e827b300e143211e040df672b9c07785bcbf3f7e1ccc9d332f31da973ea55cf8b2e059904d3c78f90e8c47d159920c7e04cf51e4eeb5aa65fd1eb3de3dc393a4d163a650fb04dacf77f8d2967f22388e09e017232af0284ff1ae521f7f3f50eceb4c5b50a8b83cb68ee3c3672032a6aef0b77e8d91216a075b1204b99e05fa73a596fba23cb057ce5bc87060b1c79c3b61fc754e5899a022f259755591b70e395c4b5570eb213d9903ee00cdbb35b756faaf534cd4f57f4dd499e7d1a7426b8a5310d8d22fc0ccfdf61bf32973287bae316e140a0f6213b84ff561ad05a6b14170b9a370b94e1f6ef350741c027f74c7d537ce37f9414f94cc4b943736ff0917e5e8e951910e6c2adbddc2901b479867ed79112de738b1b88218961a2b511856a2f31db27ba59840b514e5867698af8063805ee0f27de352315080fe5fb6a3af2d1a47f1d866f239dd3a064fb7ad0443383beee1e895671e9ee72b55b74af2232771f4919cec8cec2d048b771ca3f7c8b56719a815f184037b25df93674156eb45a3a8e06d39a82055b034bb20f9fe04356ca61e6eb453e4dc46997ab04e039729c1151262a94d7e2f1a2a4301e1d317290990d04492ada39c4b5f482df64af5dbfae4e23f1d756fbcf5515a769435c12c1418fa3ba65a6d4ae097567c5c6101e01e54827166dc9a571df015a2f1982f92420b0d263713219ef196a4947d778bfe33e8a2621f31a33873e717c77d2f27647d34024f93fe0d4e10622d25ff6da753508e31492084c2b3186af21d114d56c1ccceb08cd650946d97c48ab2b781a9b483d0f30200bab868c784f7fa76170f2f089da76c6d92d53014985117722af91609ddd0156787d7e5526a08832598ec3c520b6c3b3576f7a9ab38167789be5d121861801cfc7b481df5c05f8f50ac81e9ee5b87355e5ace9a458fbb39147c040446ccc23367e15f1ec3ff29ddc71d7936c02faf92ae4050b0003e7d61fb01843dd927209e5bd1ed434117a80cca2696126d31b8247eecc15588ab5e75b1ccd76a6896f218a622c2f8edf64243d3feb32c595587e17efa6dcc2845268d5a31dec3fc25b20fb6cc6ccbb394b25e01490908b6995491a14731ff86c3832d055308fb64c8d0915537fec5dc3070d68ff007fd32b1107b7eea678104b709100ce6cf16bb6ea005e821bfa1c953ac817b0bcaa9aaaf11a4f65a96dbe93aa3e01ba00986f0dde2a1d45fe437d46274ce4ade7f667c9d5fd4294371e2284c7548152f07ed403fe23609d18cd76b7d2dba801a2dbde5208281c9ea6f2718fca7580b0122b4c7e5611f58b11806029d9f5b6bee8a1356f36973666b8cc62cb6c7881c7301281f4ac13d40991b389fcff839cff80fa9f6ed902fc03641c852994f08388d9160c3dc4037f6e009d066e9cb8a7c3029e1ce8bb3e07cf16bb155379df735caddc303a3d1e9e183b0db8bc938c5a32e759e6fff946d9bfcb92bae2ca270d0c03690c076907f53ad57cf3dae34e27a065908aa5611c823abe8a2927b900606e3e488e7e811feb8dd6186beacaaa98a746fc3676d2c653bac8b5866fada858c30b4d7a5a6e19282a51cb962993c31879cfb49db24e0306faa3bd816e83a3617fc435ac8b52073bdd249d03e6d23c5b83b10c0c39b40e23596bcbac5ed4faafc0d103683b7e1c652053c7e2595bd64f1ed1aa591bae51e3f4b86b5c2397b64daa23d2e2099d25f5f15a148414aacf1b573a7e632ff4f1c4f7c0f1d5bf81814ffb19436c6217083f6b98d2b631aac5aba1b865810ee4e46825f9be660dd32d7547dbcc3e9c871e94239a106c4444900d8d29d2f5ffaff213433acdc6f76310e6bb6c020c42c023ca02c48b0ac9d2f117fc070dc991d61c907445e00e6c97fad16d99b777aaac12357ff20b87c1b36c62642c9ddb2e65de9a75437dbaeb93e5ea0d283478e1f12737084102187dc849b175188e1168cd24eb23c7800844d7da9dcc977085532b1b45f8a51c3294dbeaa1d46d58c68fd4f3702e2ec59cfda4942b028fa5358b8109c78f7c5ed1158d5e13639074dab80fbfc55aaf6d89a07a26e39039f10bacd9183dc9bdba097f73a1d20b5976645916c69af36ce7adca53a8dce76830fa0ba122dd0416f7a2bb1a216c1d25e8129ca3df39af0f99cc667b3bee8ad8f214db070883aa26472f93925bc6ca894dbc686dde3f57c990de2e309b85cf541fccde240ec17e7ef4aa769a8abb42206bf94d66b87d4db069d412a24a8dcd8af57c60ee02c800f8572af9cc918fb64e443cf2c48da375131df7889de683cc7c2f63dd6002663f447e036daff77e3acac91920dacc6b33e3e396e8b8ca93204c05faaf1901d1ce539d4c91008c5bba94075d53fcafccbc890a9f8bbc503dc35030b227ac1b813452d7ba67ef535a8fa4475c6ede9f1790779af5cef44c87fc057ac871e32d53e5c683b77d0298dc31b764e0413c6f3ad2cd6e07892e906db147fbaaf41305b7f9b04d0a22c07f0a5d548b6209490d020472f215fa6afc1f51c15807def3016ec6e6890c8649ca63c3edc9564ce5ecfb20246b8864f626e46b8f30c947022705df1d29b0a6ad4f712ecda83b4fdfe473184c3cd0e333d2e8124f1a1ded5801de723aa55163296e2cf870f101858a5d02e7097185a2659aba3f4bd35eccdb20e5e9632e06ee788e2454ea93f0963e129291fd5ad0b74c2daf9119de67758125d61d4cbba0fb6327066da9aa605f006fd0441c96b5a3be4b109134aa67df260a6073eb8c165caa80630dcdd6b4741cbf9bc95a1f7b6ba589ce6dde210fc54d21f9aa3ffde36e54cdecb59306e91c8f56565ba82e34e267ffec0ec88d606b980997271b2cffc6fc7955df694b403f0792d3e720da3caff24a191f61be9dadad15c512cbc763533663fb285cd3b004bb2325c31d3eb1f94f7b3ab6d147444f4f1dc2e2913079ea98611f069d935c9f992143406ca554640e2241f4612924fa1f2c51a8073f1536b3a398e21f1b148ce8a2c775429730b9c0c7b39c9bf0713a540bd7a3f540e210e881a024943fbf1ef1cfb702276007662a95133b96ab143d1f123a6e064ce96b8dcc93e0729824450dbcd0f478be9bee899e9ec41f511f7b0f109b441ccb1e57df078a6b30efb8539d6d465765940d6f6c9f881a38bca969f51348bff254f5ecba765d65188d5ac78e65ec95d11b3cba20b3d49103c12b075925af2a6274e881c9870c9259d4e7c7a15b6f7ab70bbacace03788a6940518bb6083f9937138a9abf1f18d875630ce634f92831a7ec5a0da5a646691b2ff626a50b7046152ef8fd4920579e4a6b5c5fbcc8e265a3080f3e1d3df085d79ddaec5122dd629d482179b0d7e228875556eb80529d574f408ecd68008591aeb9e5cdf30537f717113ed9584383a1532608f15bff1aef1cc7c97fa9cba967929baed0541525dfe632a87ba4e6a1983358103816426eeabf0f6c892cb5eb3646ccc9c2a00cc3460ade631d501f138e7730ec3eb688f7be51b85a88bb376bbd22044af16a2f87f80f4e19ae6598505aee5d50b76d4d8fe065f8d0a0a8e39353e3d500c15410745780312ab37d7fd4dd547ba52ffecf82808622381190703c5da20a05bf090e0547242002d1876360e14e598c77f5631dc4ca3504afab241fd8a46f2108e61bd49fb3c6b68a0b88542040c4fb55026215ede0d462c584ccac4a49de323bfc24136bac920ad35e3d57ef0bed109668808de168d2c6124f7953cc6f555abbab09ce6314e4162f2c8d22fe98e47c1a924c40e7a7442811956a698896e5476ad4102959ffd8e431d4f6ff54c4a02dcf0310ab5efbf861d33d82c0d7f04a98350d2a992cd403e18ca10b6920542589ba7feaab415904f18a7433b8948c0caa2b0b0a337b3abdd3d8ed7645bf4cb6fcff54793de871fcb1ec6a404aefb9ee2d0f4b2becbb3b8bfdd9a92f1af95329626b675d9387ff2c618fe1eb63dd8d4491f9fc2aab59a14c8ed26539856e0643ae1ec119c5572ff66ef4c6137c8be51460555203fef8693da689035b6b94fb49fdeec7c55c59c834ac15b1fad3049e0df6e63823fe6521399b750eed91f3fa2c2104cf5bc0bc49718013ea2946734b99b77a1d182e12dccd80abe43cc14a92b0762bc97a2b57f4c29ddfd4f0384cec0552ce95091efd6927dfbf6ea56fa4ed51f4af716024c1db46e7471c9dbd821fe093e55a1785bdc00435f64e9c25a6d72846ce6c5ae57033349f4db98b99c02a93c79e72022f658b560e8ef014cf170e1c0345d68beec3f39516cdc796109a74f40119f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000263fa82c5af5d81ed9daafac82f2a47c1301a08ee55c69b25b7aa6628c271ffb0f896c5d6c7086a7c31f51e63f9bce1a67afe138dd4dbb1e33df24d127944107186a82d5c9930fac62bbe6b707af93609ccfccaf3b1c0656f17b15f9f4364ee815b86fd839623a57a898ab1c5238679b1ef3240c76e5e56223ae2f19603bb15001b229f9294761247a8452a25cbe88cfed8b965c22b7eaafa5af36a520307fc91818c1c24cc910a3b1a050c5d403f9567c8ee1ba1360214b783bfd9765a20886167b990fb9a7dcd00f2613fbda9d78d85dfacadfad1a06262717a757366cb33e015f2bc0b3e4451e05d855485e0a9d51fa0ecc558ff949c1cc7a72fcd293999b0967694fc0b17a02881de1016eabbc7e1fe2ec2404c6ad62ade321e6b910b7dc0bbd82be18ea5553d1d22566c15b662c0e4cb114f36752e123e9d049b3609d25189ea50adb68a764f3d7fdc191d99d95722a1fb0463d48d99226dfcb76d94adf00822f5f09ee5ec8ddcce7ad39cda669da5cdbb625f873263216f805d43ee2c61b272535ada70e09b3742f62c2a9b0f0bc5d59a0169fac52555e25f1e8f9eea31e5bdaeaf220283fb280a3cb2053c112780c483e60d14ae299c8b008b55c034415403a5d6ed81d94917c1a32af02ae8b9a9d237a6b5c4116d3cf291385603da20f50321a5d6685ffcf09171236df982874460091950bb9094e92d04436cb4fcf0748e55f3ecceca9117c78c22229530507ca921307c16f035c1a63aac7540ec629d8c6e6bc8b94b4dd9ac5338422d6b27fcbcaf4315c0a528da2bb3b536f8a1e187ebf9499f5d0efc5a2e4d56c562a3ea4032f4247949b545ad9a06fed8be16f122dcf028a52c8a72155c66b521fde6a088acbaac2ab5d5f744b81b3b52af5bf12b12db7ee6599b20e6be77eff21e97d2234965ff870c002ce7e2e98b88967e91d92e1825754b1e51b452cf221e8241a68e22d6a5d2853e9a06308106fd080c41ca3334194ff5386b36cb9d93475a51337443e759cbce65786b11efb6094a83610ab6e70e173a8f5ccad5785b88b29a62113f5c525e6da6fb940ac1d42d18624193eaf621980088bd0fbd716d26683245f76edc4af78aaa53ba18a8b6097f84f2d273b0bf847c2473f72fd42c1d1f1c24d026f45bf2c6d5196d7295759a41e1325ace9b294cd1fe4d9ff99992543c707801b313c3fc4bc00b037f88b78e783831f3bf5f3c18421ddd2be8674603ccd0527d2edbedcaa31da160c6c54aa05ac5d06f6010259779785dc79e37d82ba432c381b464b12ef5eba5d18a2cf6ff2acb00e6dee3e1401db1241739d9316b91231739f4a31ccd870c90571fdc95008984d02a70d504e529fde3741a47e2b49f6eb1ef91a86578345a9e8391563b8031ed40f39978b646efff54fa3205b6cc805dbde924c9fc2df64dfdfdcb4780c3651432c0d69f0bae0971a3df6356d4c0f97008e9c236b2cb87b5ec83413924864cfe420f8fe6a329ae3ade59d7dee5987ff1996a21013eccd1967cb75adfa1f57b793296aad954e9b3b568a6237ca793f0ea9637470795d7d63d0ec0edb251008a9361eb0ad164fac4cbf3023d791b68e9d85364e6584f3ca6d7c43c51738b09a9d0c0487691da195d7d8f8df2a3d514358d6f26b85cb44566116e766dc1e22247e0d19d60af2eb1508caa10955f4859f20e2fc6ccda3569d473eabc4a699bf0570350c56bb0ef52d44f6f238a2f74d6c2ee5ed55c7f3ba8a902970f3e6463bc9def3291f83fdeb8f4e956c7a1462289bfce95745463eab7afce36b9168d005822c09049318d0cc05f74a9cfdd890b9fb334ce9602832b44bef9510021cac0b08bca10837959b8bfecd48b6c4910d31a93ffe528da70b06a751707daf106779ae02830e644f019d76b18811bbb3457e02429cafa58db71910c8d25cf9b0eaa998773f018090f656d296ba793e79d03b1ad0b393384da7224dc3ee2b20081f4343d5ba"),
            commit: 0x2e1541ab92f485f0f6055c009ef01f394c1defc727a5701793dddfc3b03820d5,
            domain: DEFAULT_DOMAIN,
            pubkeyHash: DEFAULT_PUBKEY_HASH,
            is2048sig: true
        });
    }
}
