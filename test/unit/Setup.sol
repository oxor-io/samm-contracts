// SPDX-License-Identifier: GPL-3
pragma solidity 0.8.23;

import {Test} from "forge-std/Test.sol";
import {SAMM, ISAMM} from "../../src/SAMM.sol";
import {ModuleGuard} from "../../src/ModuleGuard.sol";
import {SafeProxyFactory} from "../../src/Safe/proxy/SafeProxyFactory.sol";

import {ISafe} from "../../src/Safe/interfaces/ISafe.sol";
import {IMinimalSafeModuleManager} from "../../src/Safe/interfaces/IMinimalSafeModuleManager.sol";
import {ArrHelper} from "../helpers/ArrHelper.sol";
import {IDKIMRegistry} from "../../src/interfaces/IDKIMRegistry.sol";
import {DKIMRegistry} from "../../src/utils/DKIMRegistry.sol";

contract Setup is Test {
    //////////////////////
    //    Constants     //
    //////////////////////

    // Safe in mainnet
    address internal constant SAFE_SINGLETON = 0x41675C099F32341bf84BFc5382aF534df5C7461a;
    SafeProxyFactory internal constant SAFE_PROXY_FACTORY = SafeProxyFactory(0x4e1DCf7AD4e460CfD30791CCC4F9c8a4f820ec67);

    // Helpers for tests
    uint256 internal constant DEFAULT_ROOT =
        3693852034816220969980398025931646744713742489852125909138985185751997118833; // From 10 default anvil accounts

    uint64 internal constant DEFAULT_THRESHOLD = 1;
    string internal constant DEFAULT_RELAYER = "ad@oxor.io";
    string internal constant DEFAULT_DOMAIN = "icloud.com";
    bytes32 internal constant DEFAULT_PUBKEY_HASH = 0x17655f0139cacecc80f4143fd28e7107ce6038374ea9d5cfcf5d3fb5ce0086e6;
    address internal constant DEFAULT_TO = 0xdAC17F958D2ee523a2206206994597C13D831ec7; // USDT on mainnet
    bytes internal constant DEFAULT_CALLDATA = abi.encodeWithSignature("totalSupply()");
    uint256 internal constant DEFAULT_DEADLINE = 4884818384; // Tue Oct 17 2124 05:59:44
    uint256 internal constant DEFAULT_SALT = uint256(keccak256(abi.encode(777)));

    //////////////////////
    // State Variables  //
    //////////////////////

    // Safe
    ISafe internal safe;

    // DKIM registry
    DKIMRegistry internal dkimRegistry;

    // SAM
    SAMM internal sam;
    SAMM internal samSingleton;
    SafeProxyFactory internal samProxyFactory;

    // Guard
    ModuleGuard internal guard;
    ModuleGuard internal guardSingleton;
    SafeProxyFactory internal guardProxyFactory;

    //////////////////////
    //    Modifiers     //
    //////////////////////

    modifier fork(string memory env_var) {
        string memory RPC_URL = vm.envString(env_var);
        vm.createSelectFork(RPC_URL);
        _;
    }

    modifier enableModuleForSafe(ISafe safeContract, SAMM module) {
        enableModule(address(safeContract), address(module));
        _;
    }

    //////////////////////
    //  Help functions  //
    //////////////////////

    function setUp() public virtual fork("MAINNET_RPC") {
        safe = createMinimalSafeWallet(ArrHelper._arr(address(this)), DEFAULT_THRESHOLD, DEFAULT_SALT);

        dkimRegistry = new DKIMRegistry(address(this));
        dkimRegistry.setDKIMPublicKeyHash(DEFAULT_DOMAIN, DEFAULT_PUBKEY_HASH);

        // Create SAM module
        samSingleton = new SAMM();
        samProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataSAM = abi.encodeCall(
            SAMM.setup,
            (
                address(safe),
                DEFAULT_ROOT,
                DEFAULT_THRESHOLD,
                DEFAULT_RELAYER,
                address(dkimRegistry),
                new ISAMM.TxAllowance[](0)
            )
        );

        sam = createSAM(initializeDataSAM, DEFAULT_SALT);

        // add TxAllowances
        bytes memory data = DEFAULT_CALLDATA;
        bytes4 selector;
        assembly {
            selector := mload(add(data, 0x20))
        }
        vm.prank(address(safe));
        sam.setTxAllowed(DEFAULT_TO, selector, true);

        // Create Guard module
        guardSingleton = new ModuleGuard();
        guardProxyFactory = new SafeProxyFactory();

        bytes memory initializeDataGuard = abi.encodeCall(ModuleGuard.setup, (address(safe)));
        guard = createGuard(initializeDataGuard, DEFAULT_SALT);
    }

    function createSAM(bytes memory initData, uint256 salt) internal returns (SAMM newSAM) {
        return SAMM(address(samProxyFactory.createChainSpecificProxyWithNonce(address(samSingleton), initData, salt)));
    }

    function createGuard(bytes memory initData, uint256 salt) internal returns (ModuleGuard newGuard) {
        return ModuleGuard(
            address(guardProxyFactory.createChainSpecificProxyWithNonce(address(guardSingleton), initData, salt))
        );
    }

    // Create Safe wallet with minimal settings
    function createMinimalSafeWallet(address[] memory owners, uint64 threshold, uint256 salt)
        internal
        returns (ISafe newSafeWallet)
    {
        address optionalDelegateCallTo = address(0);
        bytes memory optionalDelegateCallData = "";

        address fallbackHandler = address(0);
        address paymentToken = address(0);
        uint256 payment = 0;
        address payable paymentReceiver = payable(address(0));

        bytes memory initializeDataSafe = abi.encodeCall(
            ISafe.setup,
            (
                owners,
                threshold,
                optionalDelegateCallTo,
                optionalDelegateCallData,
                fallbackHandler,
                paymentToken,
                payment,
                paymentReceiver
            )
        );

        return ISafe(
            address(SAFE_PROXY_FACTORY.createChainSpecificProxyWithNonce(SAFE_SINGLETON, initializeDataSafe, salt))
        );
    }

    error TestRevert_moduleNotEnabled();

    function enableModule(address safeContract, address module) internal {
        bytes memory cd = abi.encodeCall(IMinimalSafeModuleManager.enableModule, (module));
        sendTxToSafe(safeContract, address(this), safeContract, 0, cd, IMinimalSafeModuleManager.Operation.Call, 1e5);

        if (!ISafe(safeContract).isModuleEnabled(module)) {
            revert TestRevert_moduleNotEnabled();
        }
    }

    function sendTxToSafe(
        address safeContract,
        address sender,
        address to,
        uint256 value,
        bytes memory data,
        IMinimalSafeModuleManager.Operation operation,
        uint256 gasForExec
    ) internal returns (bool success) {
        bytes memory sig = encodeSenderSignature(sender);

        vm.prank(sender);
        return ISafe(safeContract).execTransaction{value: value}(
            to, value, data, operation, gasForExec, block.basefee, tx.gasprice, address(0), payable(address(this)), sig
        );
    }

    function encodeSenderSignature(address signer) internal pure returns (bytes memory) {
        bytes memory sig = new bytes(96);

        assembly {
            mstore(add(sig, 0x20), signer) // encode address of approver into r
            mstore(add(sig, 0x60), shl(248, 1)) // v, indicate that it is a approved hash
        }

        return sig;
    }

    // Since after each contract change, its bytecode changes, and thus previous proofs become invalid.
    // In order not to change the proofs in each test, we will make a default proof.
    function defaultCorrectProof() internal pure returns (ISAMM.Proof memory proof) {
        // Proof:
        // Tree constructed from all Anvil addresses
        // From: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 (0 Anvil address)
        // Calldata: 0xe75235b8 (getThreshold())
        // Call type: Call
        // Nonce: 0
        // ChainId: 1 (ETH)
        return ISAMM.Proof({
            proof: bytes(
                hex"000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000000ac0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000a2c270bb892ba702c75e0cbb02f817611a00000000000000000000000000000000002e98b74a2ce25e7135ce3d60c1c4e5000000000000000000000000000000ad23325bd40413efcd6e93f2cba4abeb51000000000000000000000000000000000014772a1beefa50135833eb81f655a80000000000000000000000000000004b57c3c58f86027ebdee54d859fb7d02e100000000000000000000000000000000000460d38063be8507f5bed71d8008820000000000000000000000000000000fbddaaf910bfb761a502280bc7ddd820a000000000000000000000000000000000007166c7647a3c8b0d22eb0264052330000000000000000000000000000009c5feae6e73f1af4e009caae89d859f9a700000000000000000000000000000000002fa5e5fefa8465c6ee3fec5774d8e8000000000000000000000000000000d0e18f30290657893c96b23e18ffa465d100000000000000000000000000000000001413c4fdcb02d76374b74deb4284010000000000000000000000000000001906cc15134cf2b3d35f2c8fc5772f5d000000000000000000000000000000000000008f5405abd478c05ce3fea4d56172000000000000000000000000000000c391e7d72816beb74f49509110f9292b4a00000000000000000000000000000000001da4082858c0c682b430434c4c348b000000000000000000000000000000521632cbff09eaceecfb2efc2f975e4b44000000000000000000000000000000000019a2523f2e094e47c97eb93001280d00000000000000000000000000000090f51799ddd8c984b91ed7721965925050000000000000000000000000000000000016409fe1d74c4af84ff427be3fd919000000000000000000000000000000b0befabf0ae3d131a8ced776aafc643a2c00000000000000000000000000000000001b75c74add6e72baa9645670c1f650000000000000000000000000000000767df57405e4d052393f4c8638682fa9bc00000000000000000000000000000000001f06e8ede4fbadc392f53d2fc7c217000000000000000000000000000000010efd921b10d84b9ec0741283ca31e423000000000000000000000000000000000001c693c20eb6ac433cfb8e2c47ffba000000000000000000000000000000990000ed8adba6a335c41e2c4ca883f38900000000000000000000000000000000000c8f2fd7e6a4b6394bbda200559db50000000000000000000000000000007e4d25365d3138cddaffd609c8c4a4327d0000000000000000000000000000000000272fbe8fa56d4b371190dba846006b000000000000000000000000000000bf39881a2cb8b4c39c8f4d7fbf80b25a2d00000000000000000000000000000000001cdf0dfdaecf1cc98c24e5be5ed5300341b4fc3a48fd71df31c023d3a55cbb5168b37f0543fa0d08c56988d23182e62d229976a6e8a2b7d91e8592addbfba1d6cb34c9747576843b1c8c0b1dce7d1b16949f59ba9f1e126ec455b1ca1ed0e6cbcd392bfeef58ca30f620ca35a9a83a0ff47b14aac3068c5afc430dc64fd2b58e1fe9e1583b4389d00b15644d16b63c2424e5f30d4427a98acc4208b8657546a745b441f48b637acc6bc62e2ece4e362ecf35d8880404b30c95cacb6941cc7e82820034e324072b40feb605eae7dba5251b48529fd075d8ac78ec666f0268becd24e8ae83ec9f3e2dd89785094761f33016241ae49d1ed4cd4b45b623c63e3030cb25ac24b545fc54a9bc6a607f54331985cfd8ebd0b70556a108ae0d1156f6707d5efd16a5e57047e9bb980780f6e20f0ffb8430d3663746f3bccaecd6e72c1f95bf3d737d2b0ed09e174b4fe63cb32b2fa019682e3d08aaa8360c0ab5774c82145432c93e7c1c19ad643a6de7fb6a12cd3500ecde142f5c252062c7a2b8fbe47f55b24b52846663e844972b3e1fe70592d439ca2377d09f4913c03f30ba668e4d7d762ee4e065abb481052c56df2f0a7e776c539642620c7c4699205d85aed54722c6e3aee884bfb4fdf0d0111a6e114e66bee0ff828153bc8ff84b13792f98f2e0e1b27c1291cdc47f45ec0600cb16d2512e48018af23e125c8faad39ec15d0a3eb260c8b68012d96ea2b561ef0928ad11013dde378da2f3e9151d14236101c880a1ed98c70f1f79188b86a6c6e614459ed1910df28a648eab4dc7605b89af3176e2830e2f6e1a418a2d79105ee2128bcd33623bf4e0e812825ebfbbb787efa163bc186a639d2deac0dd79a776d8224fbc9ad7a065ab09270305cd300b03dc7323d817db52c2b6a8b2a3e41feb24040816b9e94eaaa9c6eaac6782562c9545f453233729ebf5e1a5996dd087835c255004ff1f9b74103fa9101d78befff847e1a395bd9e74f0a419fa1089f95d9b15694be38203ca2b36455eea45e7c7be2f76eda4f60d151e21d76ca0317882842e83bc7e1a65e1c8bac1857656e21965692832dc10c5c60b77c0ed6facf1a21b131957376ca9419a91e8b75d7662ebaa5704dbaac47e6259ca58a35807e78fa7001ee787a6a92258c8bc1b952b5609a1db9b87d835db9561bc37d36ae3f1e95504786d2d313dc76409e5574a084be6ea97bdb7a906b1f99a3ea70f79899a18521885702e6d92551086b01dd9919df214af904572c6ce666a287bf0381e6afeca0abeb475eb3784764e1105c6c6a76ed9a0cc235e17623ddbd6612d63a2fcd308250b78adaf271552bb50893d0660a3b3d203aba4186c8dc842513d65cb369d19161246a8ae76d07e60485843701516fcf220b2e2e84d79a0cef154fce831a3fe16bfc4c6f5cd3e6389c8b4995fd11b37745d6a7b31ba28c25855ec0a93beca82200801fa9f3eae73d8e8cc6b5c80e1db966922eb6a8ed55a0f32cc6cec650bf71e1a1eab86485c0d810d5b0d9c74603f017303db3e78ee2a080a808f35ae9dc125e71a9beac00bc11f983847c6e6cb870b51328117cb444fd09dbc7ae2ba2571141c67a7c21903f5bcfe960f594656d416d2fca49065d5b19aec3ffc3b6059233017eea5fd7da47c339fb102878f1afbf99d8e9b475f3b4c8dd49e0a20d086521db768df32b0dd7d174a44cd4f35bca89a6cf103bb37c215661441083f774edd248c8213b321544272adc1222ec2787ca69e58726ac28ede4024c1d9428cf80f2963d581dc565158892a93b16ce92afc9f70d76b2d13a9f25ad1d797ea982b951cb0c43774ea5988c3be9031ff588998a809b73427290f1f8eb15c57f2a720e22c5cea529673753c63743decd7ed6c0396e01a4a81a0b96dba7581cb07d7a14d0c060c6994a39685f93ae060800096848f9fcf51f2a0428b70743d809bacb5cb08948a903502221d7f0b3f6766d9919f7673f2a9df3e09b6d03bd9420c21e8391aed04599bf10e1961502789c3cbb56c2f4379f9e47c9271617fd538914c321e16da5a0bf80af688b4d5f6b5140aa5dde02db94bc97be8855842eb314f0e2d7e041ecd03f24ff250fbe897c89337fedeb7574a8997b0b2e6b1a6ca0449c3636019a46bc291ef6d4e449450b85975353abba93576b1b3bbb8b12ef2b0c249e0961d126bd9a2d7fdf97c4664e77b95dc6070a5d127d5dbcda9a980edc338d4d004224d3fe17058f6e61afb5cb9ca92301ef3e23b59ffc07ef3b1dc49dd0fa2149d0c519de45f41eed0d87abf4c1cfffb7521863026213c0cf2697af6fe6e0afb131d08759ba01ec55b9c1ed19b5137e2162c237b55b10de23da3f6b3fc756d5e8e25f8a551357e38e8101abfae64f11bf9ee4e2c9dd7a6479a4ca278faaf5d7942085e24be6a502ffd186bbb94db7cdb62601cdbfe3f6e607ac2dabdaa4a049e80265b486783c784fdb5973e80b5715d50ae28c6bd5ce4137201db570beab762541d6dcce49df7e536512dc1e80099d4f75ecd942edc857168e6ec652b253158ab07999565e58977e4d45081241c69070dc5bbed2700d362cd43f07285c744698d132e08ef3e93bc983089b7060932b022e124dac1810b3a4a076060f7e5b53c5501ede144bc5d7da89a43b8fd00433658d3daedf9a183b69310fac39cc9b2cd151f7cab73f878de026ddba38d8dc02991fea4f0c168631e9987217fe89f0c8210108248150f276e4468bc9f0fc3c3cad433b780239ab14ea8f2c351d9a5e00e210f4e55eea480d1364cbe2324e2e013810b286899e7ba579c40e6d0e4644207b310bc844a701484b5cceccac9a1382ed88026a27010a1329d73703c1e0418d5dc073b1eacd05aaa2a4732f14c0e04734bcda0e2433a9828eef72cb2e9d10e79a412aa1edc93896e59d209b8bc440acce286dd5eb03778e16bb0448dbe8312b391193568573a6ba55c1e80faf4d3fd204585a412b468c2cbd861a8ec0f76a3364b10ed041a6abb3eb817d29766df488623f198a78c110a063fc0ed2e2a70131de9193b81660034d39c25d0ae0b79ef2a9cf9210b95d719f8e7942536d4aaf2fb7c2ebdf5bc54fe53643bbfe7965bfe11c4b2eda911f041c1ea4b0a7929ba490c972a217a16f4c9dd1948cfdfca755eafead3c6f55ab5907fda07aa95cfff0b768806cfc1c0fefb9c0e3502a54f1c5c2c1b105e5ecf813ac4f5055cffd116711ba32312bbc2a20beb31916b9fc3227df27a2cd97315d5d951008a21dcc2801b85aa09c8c0dad6b8c3ff8890cb72fc169378f73b16981ca37796b507fd4517afe5d2290ad20d2c443a7b205434890e891ff90399eaf932b1cdbbf0b4a9a217ba07260f01e50345f38a28b4067e93fdb1ae229c9ac4e8ba84bd55259a8425383774d40d2e29cc2c346dcd9a0a6c72d85e6fd98f62851aaa2bf4ee5f845ffc9fa26bf42bccb7c1ac9265b6814b9e65c1dca2ed597d50a97af1094cbee1e1fd2b09a6c11044fbdec1b23f26231809850782e9bb2d1091a8e47e61b33f55c7f6d6a2a3b21a198de434e4fd0f57fdbd53ca828c8d967eeacdf1bad18bc378a72d6a6c748b135625f8221e89e82b1954c8ffd1b639f4dec4919e2e423258fa4f4c1a02a80b08d8c1e9616fae540db70227aaf00b98d329866fabaa6ca0055f8444e8440bf325efbeb0881fd9d4f3049d98eec9299c3cb8d4ddaf8b02aee9de25fe1636880b002e8e3bd54d243b2921271fcb3555d7401ad580dda00d507d00fecb54ca21881318fb3d1cce233cbbf0f369b9c35cd10fec78d3a080a7f811dfe321a14ba3590dcd36a7a888f021f69602dc2bcad93a8eecdf2a848f68dc7de5f7595bbe10d1068689cc9ce76088c1fedd5a4af41436f5a131cfef5a43b79a88dd2d529329ff08ea85ea9c3b0b0310cb6965b9ec77f7b3a0e1967726e331387b064160ef3c871e347819cf5cf4e10c20f542cda7d19fdfae6df8ab7d48c1f016d4a57e7551431e87564230872795464d81bff3f3c396cda5b70eb617ad46b9b4571bd5ad316826ca64fa519d80c29d8dd8be9d1e1925a90a1047be046d1902c4628f5388c4ad1553e42020706b0e3854dd8cc0c96c6a2e0dd4cc7b2bb38f3f86b76f68aa8c1a01cf0735d77d903b545d25965bfb2bf3e01b252ce8041d0fc653dd3537db7a731f389c2c83395e561d79bb9dbde124df3ccaeab065a4f10e19c0cad437733c691f731455b133d748e1ce0ae68b566f5b5863d79ecc0e4d630f42e71de61d302e265c21cffce8b3e14f800ee8e3f67970b1c9c76d434c096a3731a92e79e294e609e26882dc0e7c3409e1a89e0bca7e4b8871d0762f601d957cb7676bc6adf1311be1b9020930e5478593af7b733a91becd38c9b1861a556a5118a021d57e109d1842e4f33034d08627d8fae01b1198b5a52fcc163bd81630de71835206e4555d07854b37843c472ad4595575ab134d098cd09bd4007849b1e3f86d3cb575ba8305dd566306739892ca8b914e31d251f8d4eb3a65c2290e12b443ce862cba81192d7432e7c5fefb0018bdb628f4e88fdebf5bd751c30c0860550748c92031ee31092130976681ca188ce06f2e03e0c05cb7ba7c33da27c3af24161c74e8d7b4e41c288a6b5a9eb35fbfa1f0bc3b2f5f198e9633c4a9099eb77c3d1ce59c8d2f582f6b40437b85d6a52fea91ebd554e8ed714928b60c939e957e432efabc58e3ce1a2f4535e1d69115282d973475314d4e9cab19f8c903836a2befcb935cc2076412141e9215ffcea3b5c0ff417478750baf1fe18144864a1565be05753a03ffff0f99f9409cb9e7a2a3c91f9173a4337490880feee6b3d74a52e14d6acbad2c1e29c36bf0f52c2ed4b31a2ca83d2ac7acef01e7cfcbd825c6a19ef786bb910f84120f9839cf886e8d04f62561909871b3e129718f41e6764f0517fdc1775be8332c711ee3b3142dc7a981eb9368b89a5e691427b8a02b87b747054949e738fa7d262f00d480629e560ad1e6c3f9ed067e0a5ef02efe1819733c6be4670006e4671dda5277d0a0a16b60c4c1baca0f3c161e4450b60c28edb4d8d54dab2c66b75a2a07e3122751701e3395676a133df722bf16f40e1279472e54bdf2e0415ed6cc0d1726ebe3348f6ec490638f700c458237c2fd3c96533e203d07af1a6fe593370f93b3138443ca8679d15a7c7c03a037a08a0a6ced8dce62c80ae5847e2b3f902209ded3131ec9521123e824007dcefda45191150dbaf7c168f981bc481c4def0d4c4c7940a8afda40833a116f70ee8e50c0857c9a80ded76cae43779d5dc97a2a67b8e5999f312c4d3035dc6e13f161c6ae228a295da2ca6ca8a166b2a3666718eec2e76c21d8d17ee5f0de70bb12eca563619d3d29ef7c5729fa72db699a0b13f2c1cc3e21830f73728892a2200b210d0b1843f320b7d70441df3653b53d8321f96abd7e038b0f6b989cb0f0974106c0d1760f7b6a2e1985760987721be29d15de310512c4eb0e96efb1055484acc9ddb3998bf027218492c84b299032ebaf038aaba142d380bc156584d7571a5eff4bf10192c0bee0b7908bdb51701076a001791bd81b826e54fae10716354a1e786ab532f25c5164e3ab61080f6ce75c2a27bafc8eabaa2f1dcf99e599f8662b6c598a64643788b76ebdfa427a4e4650ed269efb886d7a87414332f8d37759f4c6f7bab767cb584dc7fc7d56de5a2956bd0ccf93677402a116cced2558f14fe6e1a36f2f375ca7189afd12665fd00e629906c1194172c6175b4482f8ccf93a06ba3c42fffe907ae2127f813fd82153543e02dfe9945d891ab6f98b23b68d3332de21b87c8e5d837350e8c83376e990a33429ffebebeefb512c2b74ac498a21f6ba36dc07351fde399c2f4522b130b74b082498050ee1ea4846f062bda3bb2fae60a8af1aeb49f2e6056eed86705c4550a508441526c325181baa69e13ba02693ae8d3fbce1886df8b5d1682aec1dce0afe2d1960dcb99b11021d39fb2e24abe8a7e07c47a4e7693e60e3c1fbd66fb8154805f85ad5f4e207b97eca5caeaf169b3c3c0106cd962180bf693ddb9f323d6a2b1a33e573fbd11a15e66335b069349ea7f9023ff5c50a97f4fb90bb8b8d0a4ee61c2ea9610c7abed0d49b945f0bc311d7a0696dacfa7f358e50baa23aa27cf4022b9705c680a48004f3c5a32e63d7dc41e41d735eecd950a4d72d7db81e9028be04ad4f4fcd9da1f1afb74ad2bd20cbcff67d74dcff8aacba266b7128806bdd7e2326cf703069817d887b59913bc1ed2382fb770408426a427b5bdda89fea7f00197ae000c4f14c3471c65fe430c387e0c25b1955e271163db5c60e26f9fff2080c29821d64f45ce57a40afecf1293d75bd42fbfc14183a7e26b061c2746a3db0113e7a8c2bfee3d63599a8b88aab0ff247cffedacbfac0382c4a1211a3dd1b1212621c3a7789057c567461c3af8cf41b25fa06df1af92abbc397843de545f0260354fc1d70049c4faff319b0358b3ab239fee59ae8e3908582447eb89ca9d66e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000270321e5774463c0010f23d1217e6ca714f3f361794cf7c91ff7f055bcbb624e15c6133e19f0b2eab64c49aaf199c6349576f75554727c0a7f3a75e76a7256fc1c926ac7c23235955f3e2c2f792ecf7aefd067d8223637adb57662810969dc430ea37dde0e9452040836037e2978f5a6a4f1a48ecd7c6df2e395eeb0ae9ca0b11960d18337c8284858af9030a1800817cd8211a616acde2ca885309246f9979f2ce528bf60fe996048564752f0a3191a146afcdcd7f7f812472437f1fe25174f2731864adb9154f249065a2a0d7d681356069fa1b4a3f3c55f45e119f0cfdda814353a5813bd351c6900fa8f368046a596085801fd47e1c1f8d20bf102368e6524fec2d0bbb4c48ca574007efeffd6481d5a70b076c412c7878c05111def2692107ac21ca00979b9a447c3d7bfebf8fd4a0ae406b4560882fdb3886e0189e1c31855c3f3ecbeda27d4598b353b805fd7df7ed705971b1a83cd0f74acb4f7ffd920f8247c1d096c05d06b4e5940b07c5c8eb94a1513522423ed918a15cb2e2bb62b455f5a48e10c116ffe9b7df02ddf5ce38a21b7f5f110c090c89b64e0f0e41816d2903b479aa751f19dd7f9e0827eac3ce23c50c11f07c3b60bb37f2f3e1ff220d13b88013b834e2dd1dff4b0331b15e696d65f52f04df8e1e4d63debbd830f11e156a88dea9f68505adb62258ed9e367dce127f5f65e69acdb6849385e017325ae505af20bd237bc484c158fd0eb643db88aa8ba24883a690560e240418a720b5de144dde7d7192933e13b1b400ba488e24eb2afd44f8e84ab3bcc07c3265423e4bdc774dd5a02974e5cc455f59b1eff302703ca57e6d62a8ae216fa08fab31bda2db48ffa922b6ca3bf2e457ce18ed646f6d4e26785d0a035b92bacabaf6226e382731f33620ad909ed47aaeca482021777eb52c53ec4a38e2a9fd4e4da7c1b5df49cfc3f04d77c28a27dd4f5c9cf2447307f30b5437c5e50b07d495e76f90fb41e3fe9766327dff0ba1e5ab3cfb27dea65e8d39792dfd577df3ad3cabcdf2bd46773e472dab5046ada1e75845d388def386eba5a2b7d8f141c9633980bf91d6096273428b826f981ecd58c4c6dbc9cfdb419c04542fd5c9858c1e71911c103d96ad8c6e02060a112ffe255764d269746954613ecd743f62d0edf672e29490fdf8d5a36141769b38aa5a2267ccdb010a8924152997aeab099af06fcff7b61210b1488bbd1d099fc3fd6e7cbe5e6d3e4f6ed2c94261c740916d78c7c48293d1dab7250411eb95a6b5360f6bf3b878e30593cd40991d0036412581afb15bb15243b91dda5faba6658c5d1e84e8fa8bb4587f42c8c911be454ebd48dbe54fa9912687263c76aa8f3540640a4b8e283d3a924be0de7db7211bbef92a94b0ded000bd94f4411621c6b907ad04ffd5fc42b7bebd2d5e7c1085ae1c530909321daa51cb6b1a5272b403449f2b50f67ad033ec1dcf5d1b4bbbce59319a6ac152f99361c92d4bd7ce5c0df8d1cc4872f9410ec590bcfdbd8a9811b5eb79acb5e7243480028a431e60e19514191b80475e91ccbc112285d811bb79d539b45c8678145480bc144afe3d20face6425da497bd093aba2b9242151113922379f49e1a58632f0379a8f67d22b1be7c18519670845806215f65fe72b3fd45fd155989fc1f20961072602f46e58e2961bfc0263254b39970f61ebd39a689294b3cb94c18be3fc11d9b131f97934900ec84b9792fe1664d7a32755577590e2a783a05113458a1330f40806d16a5f18e2991b9cc2a9a343e992fcf123a9fd730904b6cc068b7b318135411341050008f5ab895a9c5adde5a23085650af7da3adf79fd37b5a919a7a2db672ec8cfd8a45df811a1d3be99454b8c59acf0af89ba175ede4fa65db4e521555f4244a033a10e93f71e3fd78f2274e68a6b3496086974e2a3d94a37cd3222ba3aae42589107a0906d53d925b2cf0ba17ef99d134f8ef98697a2861efa918"
            ),
            commit: 0x01e756223c5baeccc9076912dcb9c1dc0d6f1c24187f678682017e93920784e8,
            domain: DEFAULT_DOMAIN,
            pubkeyHash: DEFAULT_PUBKEY_HASH,
            is2048sig: true
        });
    }
}
